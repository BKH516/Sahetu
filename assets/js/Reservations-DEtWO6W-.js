import{c as e,r,R as a,b as t,j as s,L as n,B as l,k as d,C as o}from"./index-C0GYpyhB.js";import{b as i}from"./axios-BoVf8-b_.js";import{S as c,F as g,D as u,a as x}from"./DropdownFilterButton-qfE1EtEq.js";import{D as m}from"./index-ByUMRYLH.js";import{u as b,C as p}from"./clock-SC6hm5MT.js";import{E as y}from"./eye-ZgGUO2Ez.js";import"./trending-up-CopBz1iN.js";import"./api.config-BC7RovkD.js";const h=e("chart-no-axes-column",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);function v({value:e,onChange:a}){const{t:t}=b(),[n,l]=r.useState(!1),d=r.useRef(null),o=[{value:"male",label:t("auth.register.male")},{value:"female",label:t("auth.register.female")}];return r.useEffect(()=>{function e(e){d.current&&!d.current.contains(e.target)&&l(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),s.jsxs("div",{className:"relative w-full",ref:d,children:[s.jsxs("button",{type:"button",className:"w-full px-3 py-2 border-2 border-pink-400 dark:border-pink-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-pink-300 dark:focus:ring-pink-700 transition",onClick:()=>l(e=>!e),children:[o.find(r=>r.value===e)?.label||t("reservations.selectGender"),s.jsx("span",{className:"float-left",children:n?"â–²":"â–¼"})]}),n&&s.jsx("div",{className:"absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-pink-400 dark:border-pink-600 rounded-lg shadow-lg text-sm max-h-[20vh] overflow-y-auto mt-2",children:o.map(r=>s.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-pink-50 dark:hover:bg-pink-900/30 text-gray-900 dark:text-gray-100 "+(e===r.value?"bg-pink-100 dark:bg-pink-900/50 font-bold":""),onClick:()=>{a(r.value),l(!1)},children:r.label},r.value))})]})}function f({value:e,onChange:a,options:t,forceDropUp:n=!1,size:l="md"}){const{t:d}=b(),[o,i]=r.useState(!1),c=r.useRef(null),g=r.useRef(null);r.useEffect(()=>{function e(e){c.current&&!c.current.contains(e.target)&&i(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let u="w-full px-3 py-2 text-sm",x="text-sm min-w-[120px]";"sm"===l?(u="w-full px-2 py-1.5 text-xs",x="text-xs min-w-[100px]"):"lg"===l&&(u="w-full px-4 py-3 text-base",x="text-base min-w-[160px]");const m=t.find(r=>r.value===e)?.label||d("reservations.selectService");return s.jsxs("div",{className:"relative",ref:c,style:{width:"100%"},children:[s.jsxs("button",{type:"button",ref:g,className:u+" border-2 border-orange-400 dark:border-orange-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 font-medium focus:outline-none focus:ring-2 focus:ring-orange-300 dark:focus:ring-orange-700 transition",onClick:()=>i(e=>!e),style:{width:"100%"},children:[m,s.jsx("span",{className:"float-left",children:o?"â–²":"â–¼"})]}),o&&s.jsx("div",{className:`absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-orange-400 dark:border-orange-600 rounded-lg shadow-lg ${x} max-h-[25vh] overflow-y-auto mt-2`+(n?" bottom-full mb-2 mt-0":""),children:t.map(r=>s.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-orange-50 dark:hover:bg-orange-900/30 text-gray-900 dark:text-gray-100 "+(e===r.value?"bg-orange-100 dark:bg-orange-900/50 font-bold":""),onClick:()=>{a(r.value),i(!1)},children:r.label},r.value))})]})}const k=a.memo(()=>{const{t:e,i18n:a}=b(),[k,w]=r.useState([]),[_,C]=r.useState([]),[S,z]=r.useState(!0),[E,A]=r.useState(null),[R,T]=r.useState(null),[F,D]=r.useState(null),[L,$]=r.useState(!1),[B,M]=r.useState("all"),[I,O]=r.useState(""),P=function(e,a=500){const[t,s]=r.useState(e);return r.useEffect(()=>{const r=setTimeout(()=>{s(e)},a);return()=>{clearTimeout(r)}},[e,a]),t}(I,300),[q,G]=r.useState(1),[U,W]=r.useState(!1),[H,K]=r.useState(!1),[J,Q]=r.useState(!1),[V,X]=r.useState(null),[Y,Z]=r.useState(null),[ee,re]=r.useState([]),[ae,te]=r.useState({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""}),{isAuthenticated:se}=t(),ne=r.useCallback(async()=>{z(!0),A(null);try{const r=await i.get("/api/doctor/reservations");if(r.status>=400){const a=r.data?.message||e("reservations.loadError");return A(a),void w([])}const a=r.data,t=Array.isArray(a)?a:Array.isArray(a.data)?a.data:[];w(t)}catch(r){const a=r instanceof Error?r.message:e("reservations.loadError");A(a)}finally{z(!1)}},[e]),le=r.useCallback(async()=>{try{const r=await i.get("/api/doctor/services");if(r.status>=400){const a=r.data?.message||e("services.loadingError");return A(a),void C([])}const a=r.data,t=Array.isArray(a)?a:Array.isArray(a.data)?a.data:[];C(t)}catch(r){const a=r instanceof Error?r.message:e("services.loadingError");A(a),C([])}finally{z(!1)}},[e]),de=r.useCallback(async()=>{try{const e=await i.get("/api/doctor/available-dates");if(404===e.status)return void re([]);if(e.status>=400)return void re([]);const r=Array.isArray(e.data)?e.data:[];re(r)}catch(e){re([])}},[]);r.useEffect(()=>{se&&($(!0),ne(),le(),de())},[se,ne,le,de]);const oe=r.useMemo(()=>L?k.filter(e=>{let r=!0;r="all"!==B?e.status===B:["pending","approved"].includes(e.status);const a=N(e,c.get(e.id)),t=a.full_name||"",s=e.doctor_service?.name||"",n=a.phone_number||"",l=t.toLowerCase().includes(P.toLowerCase())||s.toLowerCase().includes(P.toLowerCase())||n.includes(P);return r&&l}):[],[k,B,P,L]),ie=r.useMemo(()=>Math.ceil(oe.length/5),[oe.length]),ce=r.useMemo(()=>{const e=5*(q-1),r=e+5;return oe.slice(e,r)},[oe,q]),ge=r=>{switch(r){case"pending":return e("reservations.status.pending");case"approved":return e("reservations.status.approved");case"cancelled":return e("reservations.status.cancelled");case"completed":return e("reservations.status.completed");case"rejected":return e("reservations.status.rejected");default:return r}},ue=e=>{switch(e){case"pending":return"bg-warning/10 text-warning dark:bg-warning/20 dark:text-warning-light";case"approved":return"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light";case"cancelled":return"bg-danger/10 text-danger dark:bg-danger/20 dark:text-danger-light";case"completed":return"bg-success/10 text-success dark:bg-success/20 dark:text-success-light";case"rejected":return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}},xe=(e,r)=>{D({message:e,type:r}),setTimeout(()=>D(null),3e3)};return S||!L?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx(n,{size:"lg"})}):s.jsxs("div",{className:"space-y-6 relative",children:[s.jsx("div",{className:"flex justify-end gap-2",children:s.jsxs(l,{className:"",section:"bookings",size:"sm",onClick:()=>{W(!0),de()},children:["+ ",e("reservations.addManualReservation")]})}),E&&s.jsx("div",{className:"text-center text-red-500 py-2",children:E}),R&&s.jsx("div",{className:"text-center text-green-600 font-bold py-2",children:R}),F&&s.jsxs("div",{style:{position:"fixed",bottom:18,left:18,zIndex:99999,minWidth:120,maxWidth:220,padding:"7px 16px 7px 10px",borderRadius:"8px",background:"success"===F.type?"#22c55e":"#ef4444",color:"#fff",fontWeight:500,fontSize:"0.85rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",display:"flex",alignItems:"center",gap:7,pointerEvents:"none",userSelect:"none"},children:[s.jsx("span",{style:{fontSize:"1.1em",marginRight:6,display:"flex",alignItems:"center"},children:"success"===F.type?"âœ”ï¸":"âš ï¸"}),s.jsx("span",{style:{flex:1},children:F.message})]}),s.jsx(m,{open:U,onOpenChange:W,title:e("reservations.addManualReservation"),description:e("reservations.addReservationDesc"),children:s.jsxs("form",{className:"space-y-3",onSubmit:async r=>{if(r.preventDefault(),T(null),A(null),!ae.gender)return A(e("reservations.selectGender")),void xe(e("reservations.selectGender"),"error");if(!ae.doctor_service_id)return A(e("reservations.selectService")),void xe(e("reservations.selectService"),"error");if(!(ae.full_name&&ae.age&&ae.phone_number&&ae.date&&ae.start_time&&ae.end_time))return A(e("reservations.fillAllFields")),void xe(e("reservations.fillAllFields"),"error");if(ee.length>0&&!ee.includes(ae.date))return A(e("reservations.dateNotAvailable")),void xe(e("reservations.dateNotAvailable"),"error");if(ae.start_time>=ae.end_time)return A(e("reservations.startTimeMustBeLess")),void xe(e("reservations.startTimeMustBeLess"),"error");const a=parseInt(ae.start_time.split(":")[0]),t=parseInt(ae.end_time.split(":")[0]);if(a<6||a>22)return A(e("reservations.startTimeRange")),void xe(e("reservations.startTimeRange"),"error");if(t<6||t>23)return A(e("reservations.endTimeRange")),void xe(e("reservations.endTimeRange"),"error");const s=new Date(ae.date),n=new Date;if(n.setHours(0,0,0,0),s<n)return A(e("reservations.cannotBookPast")),void xe(e("reservations.cannotBookPast"),"error");try{const r={full_name:ae.full_name,age:ae.age,phone_number:ae.phone_number,doctor_service_id:ae.doctor_service_id,date:ae.date,start_time:ae.start_time,end_time:ae.end_time,notes:ae.notes,gender:ae.gender},a=await i.post("/api/doctor/reservations",r);if(a.status>=400){let r=a.data?.message||e("reservations.addError");if(409===a.status){const t=a.data?.message;r=t||e("reservations.slotAlreadyBooked")}else if(422===a.status){const t=a.data?.errors;if(t?.date)r=e("reservations.dateMustBeTodayOrFuture");else if(t){const e=Object.values(t)[0];r=Array.isArray(e)?e[0]:e}else r=e("reservations.invalidData")}else 404===a.status&&(r=e("reservations.serviceNotFound"));return A(r),void xe(r,"error")}const t=a.data&&"object"==typeof a.data&&!Array.isArray(a.data)&&a.data.data?a.data.data:a.data;if(t&&!t.status&&(t.status="pending"),t&&t.id){const e={full_name:ae.full_name,phone_number:ae.phone_number,age:ae.age,gender:ae.gender,notes:ae.notes};if(c.save(t.id,e),!t.doctor_service&&ae.doctor_service_id){const e=_.find(e=>e.id==ae.doctor_service_id);e&&(t.doctor_service=e)}w(e=>[...e,t]),setTimeout(async()=>{await ne()},500)}xe(e("reservations.addSuccess"),"success"),W(!1),te({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""})}catch(l){let r=l?.response?.data?.message||e("reservations.addError");if(422===l?.response?.status){const a=l?.response?.data?.errors;if(a?.date)r=e("reservations.dateMustBeTodayOrFuture");else if(a){const e=Object.values(a)[0];r=Array.isArray(e)?e[0]:e}else r=e("reservations.invalidData")}else if(409===l?.response?.status){const a=l?.response?.data?.message;r=a||e("reservations.slotAlreadyBooked")}else 400===l?.response?.status?r=e("reservations.badRequest"):500===l?.response?.status?r=e("reservations.serverError"):0!==l?.response?.status&&"NETWORK_ERROR"!==l?.code||(r=e("reservations.networkError"));A(r),xe(r,"error")}},children:[s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"full_name",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e("reservations.fullName")]}),s.jsx(d,{id:"full_name",placeholder:e("reservations.fullNamePlaceholder"),value:ae.full_name,onChange:e=>te(r=>({...r,full_name:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all text-sm"})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"age",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("profile.age")]}),s.jsx(d,{id:"age",type:"number",placeholder:e("profile.agePlaceholder")||e("profile.age"),value:ae.age,onChange:e=>te(r=>({...r,age:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-green-500 dark:focus:border-green-400 focus:ring-2 focus:ring-green-200 dark:focus:ring-green-800 transition-all text-sm"})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"phone_number",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e("profile.phoneNumber")]}),s.jsx(d,{id:"phone_number",type:"tel",placeholder:e("profile.phoneNumberPlaceholder"),value:ae.phone_number,onChange:e=>te(r=>({...r,phone_number:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-purple-500 dark:focus:border-purple-400 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 transition-all text-sm"})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"doctor_service_id",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e("services.serviceName")]}),s.jsx(f,{value:ae.doctor_service_id,onChange:e=>te(r=>({...r,doctor_service_id:e})),options:_.map(e=>({value:e.id,label:e.name})),size:k.length>8?"sm":k.length>4?"md":"lg"})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"gender",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full"}),e("profile.gender")," *"]}),s.jsx(v,{value:ae.gender,onChange:e=>te(r=>({...r,gender:e}))})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"date",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e("reservations.date")]}),s.jsx(d,{id:"date",type:"date",value:ae.date,onChange:e=>te(r=>({...r,date:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-red-500 dark:focus:border-red-400 focus:ring-2 focus:ring-red-200 dark:focus:ring-red-800 transition-all text-sm"})]})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"start_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),e("schedule.startTime")]}),s.jsx(d,{id:"start_time",type:"time",value:ae.start_time,onChange:e=>te(r=>({...r,start_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200 dark:focus:ring-indigo-800 transition-all text-sm"})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"end_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),e("reservations.endTime")]}),s.jsx(d,{id:"end_time",type:"time",value:ae.end_time,onChange:e=>te(r=>({...r,end_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-teal-500 dark:focus:border-teal-400 focus:ring-2 focus:ring-teal-200 dark:focus:ring-teal-800 transition-all text-sm"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"notes",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e("reservations.notes")]}),s.jsx(d,{id:"notes",placeholder:e("reservations.notesPlaceholder"),value:ae.notes,onChange:e=>te(r=>({...r,notes:e.target.value})),className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-yellow-500 dark:focus:border-yellow-400 focus:ring-2 focus:ring-yellow-200 dark:focus:ring-yellow-800 transition-all text-sm"})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[s.jsx(l,{type:"button",variant:"outline",onClick:()=>W(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("common.cancel")}),s.jsx(l,{type:"submit",className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg shadow-lg transition-all text-sm",children:e("reservations.addReservation")})]})]})}),V&&(()=>{const r=c.get(V.id),t=N(V,r);return s.jsxs(m,{open:H,onOpenChange:K,title:e("reservations.patientInfoTitle"),description:e("reservations.patientInfoDescription"),children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.fullName")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.full_name||"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.age")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.age?`${t.age} ${e("profile.years")}`:"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.gender")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:"male"===t.gender?e("auth.register.male"):"female"===t.gender?e("auth.register.female"):"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.phoneNumber")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.phone_number||s.jsx("span",{className:"text-gray-400 dark:text-gray-500 italic",children:e("reservations.notAvailableOld")})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("services.serviceName")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.doctor_service?.name||"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.date")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.date?new Date(V.date).toLocaleDateString("ar"===a.language?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric"}):"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("schedule.startTime")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.start_time?j(V.start_time):"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.endTime")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.end_time?j(V.end_time):"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.statusLabel")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ue(V.status)}`,children:ge(V.status)})})]})]}),V.notes&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.notes")}),s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm min-h-[60px]",children:V.notes})]})]}),s.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:s.jsx(l,{type:"button",variant:"outline",onClick:()=>K(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("reservations.close")})})]})})(),Y&&s.jsxs(m,{open:J,onOpenChange:Q,title:e("reservations.changeStatus"),description:e("reservations.selectNewStatus"),children:[s.jsx("div",{className:"space-y-3",children:[{value:"pending",label:e("reservations.status.pending"),icon:"â³",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",borderColor:"border-yellow-300 dark:border-yellow-700"},{value:"approved",label:e("reservations.status.approved"),icon:"âœ…",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",borderColor:"border-blue-300 dark:border-blue-700"},{value:"completed",label:e("reservations.status.completed"),icon:"âœ”ï¸",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",borderColor:"border-green-300 dark:border-green-700"},{value:"cancelled",label:e("reservations.status.cancelled"),icon:"âŒ",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",borderColor:"border-red-300 dark:border-red-700"},{value:"rejected",label:e("reservations.status.rejected"),icon:"â›”",color:"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400",borderColor:"border-gray-300 dark:border-gray-700"}].map(r=>s.jsxs("button",{onClick:()=>{(async(r,a)=>{T(null),A(null);const t=[...k];w(e=>e.map(e=>e.id===r?{...e,status:a}:e));try{const s=await i.patch(`/api/doctor/reservations/updateStatus/${r}`,{status:a},{headers:{"Content-Type":"application/json"}});if(s.status>=400){w(t);const r=s.data?.message||e("reservations.updateError");return A(r),void xe(r,"error")}await ne();const n=c.get(r);!n||"completed"!==a&&"rejected"!==a||c.save(r,n),xe(e("reservations.updateSuccess",{status:ge(a)}),"success")}catch(s){w(t);const r=s?.response?.data?.message||e("reservations.updateError");A(r),xe(r,"error")}})(Y.id,r.value),Q(!1),Z(null)},className:`w-full px-4 py-3 rounded-lg border-2 ${r.borderColor} ${Y.status===r.value?`${r.color} font-bold shadow-md`:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700"} transition-all duration-200 flex items-center gap-3`,children:[s.jsx("span",{className:"text-2xl",children:r.icon}),s.jsx("span",{className:"text-base font-medium flex-1 text-right",children:r.label}),Y.status===r.value&&s.jsx("span",{className:"text-lg",children:"âœ“"})]},r.value))}),s.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700 mt-4",children:s.jsx(l,{type:"button",variant:"outline",onClick:()=>{Q(!1),Z(null)},className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("common.cancel")})})]}),s.jsxs(g,{children:[s.jsxs("div",{className:"flex-1 min-w-[180px]",children:[s.jsxs("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e("common.search")," ",I!==P&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(",e("common.searching"),")"]})]}),s.jsx(d,{id:"search",placeholder:e("reservations.searchPlaceholder"),value:I,onChange:e=>O(e.target.value),className:"dark:bg-zinc-800 dark:border-zinc-700 dark:text-gray-100 dark:placeholder:text-gray-400"})]}),s.jsx("div",{className:"flex-1 min-w-[140px]",children:s.jsx(u,{options:[{value:"all",label:e("reservations.allStatuses")},{value:"pending",label:e("reservations.status.pending")},{value:"approved",label:e("reservations.status.approved")},{value:"completed",label:e("reservations.status.completed")},{value:"rejected",label:e("reservations.status.rejected")}],value:B,onChange:M,placeholder:e("reservations.selectStatus"),className:"min-w-[140px]",section:"bookings",size:"sm"})}),s.jsx("div",{className:"flex items-end",children:s.jsx(l,{onClick:()=>{O(""),M("all")},section:"bookings",size:"sm",className:"w-full",children:e("common.reset")})})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-6",children:[s.jsx(x,{icon:s.jsx(h,{className:"text-primary dark:text-primary-light"}),label:e("reservations.totalReservations"),value:oe.length,color:"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light"}),s.jsx(x,{icon:s.jsx(p,{className:"text-warning dark:text-warning-light"}),label:e("reservations.status.pending"),value:oe.filter(e=>"pending"===e.status).length,color:"bg-warning/10 text-warning dark:bg-warning/20 dark:text-warning-light"}),s.jsx(x,{icon:s.jsx(o,{className:"text-green-600 dark:text-green-400"}),label:e("reservations.status.approved"),value:oe.filter(e=>"approved"===e.status).length,color:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400"})]}),ce.length>0?s.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-white dark:bg-zinc-900 shadow-xl dark:shadow-2xl border border-gray-100 dark:border-zinc-800 fade-in pb-4",style:{marginBottom:"50px"},children:s.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[80vh] custom-scrollbar",children:s.jsxs("table",{className:"min-w-full divide-y-0",children:[s.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-zinc-800 dark:to-zinc-800/90 sticky top-0 z-10 border-b-2 border-blue-200 dark:border-zinc-700",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),s.jsx("span",{children:e("reservations.columns.patient")})]})}),s.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),s.jsx("span",{children:e("reservations.columns.contact")})]})}),s.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),s.jsx("span",{children:e("reservations.columns.service")})]})}),s.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsx("span",{children:e("reservations.columns.appointment")})]})}),s.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),s.jsx("span",{children:e("reservations.columns.status")})]})}),s.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:e("services.actions")})]})}),s.jsx("tbody",{className:"divide-y-2 divide-gray-100 dark:divide-zinc-800",children:ce.map((r,t)=>{const n=c.get(r.id),l=N(r,n);return s.jsxs("tr",{className:"group transition-all duration-200 hover:bg-blue-50 dark:hover:bg-zinc-800 "+(t%2==0?"bg-white dark:bg-zinc-900":"bg-gray-100 dark:bg-zinc-800/80"),children:[s.jsx("td",{className:"px-6 py-5",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg text-sm",children:(l.full_name||e("reservations.defaultInitial"))[0].toUpperCase()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 truncate mb-1",children:l.full_name||"-"}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1.5",children:["male"===l.gender?"ðŸ‘¨":"female"===l.gender?"ðŸ‘©":"ðŸ‘¤",s.jsx("span",{children:l.age?`${l.age} ${e("profile.years")}`:"-"})]})]})]})}),s.jsx("td",{className:"px-6 py-5",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-sm",children:s.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"ðŸ“±"})}),l.phone_number?s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 dir-ltr",children:l.phone_number}):s.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 italic",children:e("reservations.notAvailable")})]})}),s.jsx("td",{className:"px-6 py-5",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-sm",children:s.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"ðŸ¥"})}),s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r.doctor_service?.name||"-"})]})}),s.jsx("td",{className:"px-6 py-5",children:s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-900 dark:text-gray-100",children:[s.jsx("span",{className:"text-green-600 dark:text-green-400",children:"ðŸ“…"}),s.jsx("span",{children:r.date?new Date(r.date).toLocaleDateString("ar"===a.language?"ar-EG":"en-US",{month:"short",day:"numeric"}):"-"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[s.jsx("span",{children:"â°"}),s.jsx("span",{className:"font-mono",children:r.start_time?j(r.start_time):"-"}),s.jsx("span",{children:"â†’"}),s.jsx("span",{className:"font-mono",children:r.end_time?j(r.end_time):"-"})]})]})}),s.jsx("td",{className:"px-6 py-5 text-center",children:s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-4 py-2 rounded-full text-xs font-bold shadow-sm ${ue(r.status)} transition-all duration-200 hover:scale-105`,children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-pulse"}),ge(r.status)]})}),s.jsx("td",{className:"px-6 py-5",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsxs("button",{onClick:()=>{const e=c.get(r.id);N(r,e),X(r),K(!0)},className:"group/btn relative w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200",title:e("reservations.viewPatientInfo"),children:[s.jsx(y,{size:18,className:"relative z-10"}),s.jsx("div",{className:"absolute inset-0 rounded-xl bg-white opacity-0 group-hover/btn:opacity-20 transition-opacity"})]}),s.jsx("button",{onClick:()=>{Z(r),Q(!0)},className:"group/status w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 dark:from-zinc-700 dark:to-zinc-800 dark:hover:from-zinc-600 dark:hover:to-zinc-700 shadow-md hover:shadow-lg transform hover:scale-110 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:e("reservations.changeStatus"),children:s.jsx("span",{className:"text-lg",children:"âš™ï¸"})})]})})]},r.id)})})]})})}):s.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-zinc-900 dark:to-zinc-800 border-2 border-dashed border-blue-300 dark:border-zinc-700 p-12 text-center fade-in",style:{marginBottom:"60px"},children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/20 rounded-full -mr-16 -mt-16 opacity-50"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-indigo-200 dark:bg-indigo-900/20 rounded-full -ml-20 -mb-20 opacity-50"}),s.jsxs("div",{className:"relative z-10 space-y-4",children:[s.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-4xl",children:"ðŸ“‹"}),s.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:e("reservations.noReservations")}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:e("reservations.noReservationsFound")}),s.jsxs(l,{onClick:()=>{W(!0),de()},section:"bookings",className:"mt-4",children:["+ ",e("reservations.addNewReservation")]})]})]}),ie>1&&s.jsxs("div",{className:"flex justify-center gap-4",children:[s.jsx(l,{variant:"outline",onClick:()=>G(e=>Math.max(e-1,1)),disabled:1===q,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:e("common.previous")}),s.jsx("span",{className:"flex items-center px-4 text-gray-700 dark:text-gray-300",children:e("reservations.pageInfo",{current:q,total:ie})}),s.jsx(l,{variant:"outline",onClick:()=>G(e=>Math.min(e+1,ie)),disabled:q===ie,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:e("common.next")})]})]})});function j(e){if(!e)return"-";const[r,a]=e.split(":");return`${r}:${a}`}function N(e,r){if(r)return{full_name:r.full_name||e.full_name||e.user?.account?.full_name||e.user?.full_name||"",phone_number:r.phone_number||e.phone_number||e.user?.account?.phone_number||e.user?.phone_number||"",age:r.age||e.age||e.user?.age||"",gender:r.gender||e.gender||e.user?.gender||""};if(e.full_name&&e.phone_number)return{full_name:e.full_name,phone_number:e.phone_number,age:e.age||"",gender:e.gender||""};const a=e.user?.account?.phone_number||e.user?.phone_number||e.user?.account?.phone||e.user?.phone||e.phone_number||e.phone||e.mobile||e.user?.mobile||e.user?.account?.mobile||e.user?.contact_number||e.contact_number||e.user?.telephone||e.telephone||"";return{full_name:e.user?.account?.full_name||e.user?.full_name||"",phone_number:a,age:e.user?.age||e.age||"",gender:e.user?.gender||e.gender||""}}export{k as default};
