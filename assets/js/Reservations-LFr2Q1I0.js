import{r as e,R as r,n as a,j as t,ab as s,o as n,e as l,J as d}from"./react-vendor-DWMGvGTO.js";import{a as o,L as i,B as c,d as g}from"./index-Bn4zpa56.js";import{b as u}from"./axios-lBo-y8w0.js";import{S as m,F as x,D as b,a as p}from"./DropdownFilterButton-BtmegiFH.js";import{D as y}from"./index-Cbt-g0jB.js";import"./vendor-SX7gLFj9.js";import"./i18n-vendor-aVkm1h7f.js";import"./animation-vendor-DtfVNoxx.js";import"./http-vendor-vzM7rUwp.js";import"./api.config-kPv0EHGZ.js";function h({value:r,onChange:s}){const{t:n}=a(),[l,d]=e.useState(!1),o=e.useRef(null),i=[{value:"male",label:n("auth.register.male")},{value:"female",label:n("auth.register.female")}];return e.useEffect(()=>{function e(e){o.current&&!o.current.contains(e.target)&&d(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),t.jsxs("div",{className:"relative w-full",ref:o,children:[t.jsxs("button",{type:"button",className:"w-full px-3 py-2 border-2 border-pink-400 dark:border-pink-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-pink-300 dark:focus:ring-pink-700 transition",onClick:()=>d(e=>!e),children:[i.find(e=>e.value===r)?.label||n("reservations.selectGender"),t.jsx("span",{className:"float-left",children:l?"â–²":"â–¼"})]}),l&&t.jsx("div",{className:"absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-pink-400 dark:border-pink-600 rounded-lg shadow-lg text-sm max-h-[20vh] overflow-y-auto mt-2",children:i.map(e=>t.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-pink-50 dark:hover:bg-pink-900/30 text-gray-900 dark:text-gray-100 "+(r===e.value?"bg-pink-100 dark:bg-pink-900/50 font-bold":""),onClick:()=>{s(e.value),d(!1)},children:e.label},e.value))})]})}function v({value:r,onChange:s,options:n,forceDropUp:l=!1,size:d="md"}){const{t:o}=a(),[i,c]=e.useState(!1),g=e.useRef(null),u=e.useRef(null);e.useEffect(()=>{function e(e){g.current&&!g.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let m="w-full px-3 py-2 text-sm",x="text-sm min-w-[120px]";"sm"===d?(m="w-full px-2 py-1.5 text-xs",x="text-xs min-w-[100px]"):"lg"===d&&(m="w-full px-4 py-3 text-base",x="text-base min-w-[160px]");const b=n.find(e=>e.value===r)?.label||o("reservations.selectService");return t.jsxs("div",{className:"relative",ref:g,style:{width:"100%"},children:[t.jsxs("button",{type:"button",ref:u,className:m+" border-2 border-orange-400 dark:border-orange-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 font-medium focus:outline-none focus:ring-2 focus:ring-orange-300 dark:focus:ring-orange-700 transition",onClick:()=>c(e=>!e),style:{width:"100%"},children:[b,t.jsx("span",{className:"float-left",children:i?"â–²":"â–¼"})]}),i&&t.jsx("div",{className:`absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-orange-400 dark:border-orange-600 rounded-lg shadow-lg ${x} max-h-[25vh] overflow-y-auto mt-2`+(l?" bottom-full mb-2 mt-0":""),children:n.map(e=>t.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-orange-50 dark:hover:bg-orange-900/30 text-gray-900 dark:text-gray-100 "+(r===e.value?"bg-orange-100 dark:bg-orange-900/50 font-bold":""),onClick:()=>{s(e.value),c(!1)},children:e.label},e.value))})]})}const f=r.memo(()=>{const{t:r,i18n:f}=a(),[N,w]=e.useState([]),[_,C]=e.useState([]),[S,z]=e.useState(!0),[A,E]=e.useState(null),[R,T]=e.useState(null),[F,D]=e.useState(null),[L,$]=e.useState(!1),[B,M]=e.useState("all"),[I,O]=e.useState(""),P=function(r,a=500){const[t,s]=e.useState(r);return e.useEffect(()=>{const e=setTimeout(()=>{s(r)},a);return()=>{clearTimeout(e)}},[r,a]),t}(I,300),[q,G]=e.useState(1),[U,W]=e.useState(!1),[H,J]=e.useState(!1),[K,Q]=e.useState(!1),[V,X]=e.useState(null),[Y,Z]=e.useState(null),[ee,re]=e.useState([]),[ae,te]=e.useState({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""}),{isAuthenticated:se}=o(),ne=e.useCallback(async()=>{z(!0),E(null);try{const e=await u.get("/api/doctor/reservations");if(e.status>=400){const a=e.data?.message||r("reservations.loadError");return E(a),void w([])}const a=e.data,t=Array.isArray(a)?a:Array.isArray(a.data)?a.data:[];w(t)}catch(e){const a=e instanceof Error?e.message:r("reservations.loadError");E(a)}finally{z(!1)}},[r]),le=e.useCallback(async()=>{try{const e=await u.get("/api/doctor/services");if(e.status>=400){const a=e.data?.message||r("services.loadingError");return E(a),void C([])}const a=e.data,t=Array.isArray(a)?a:Array.isArray(a.data)?a.data:[];C(t)}catch(e){const a=e instanceof Error?e.message:r("services.loadingError");E(a),C([])}finally{z(!1)}},[r]),de=e.useCallback(async()=>{try{const e=await u.get("/api/doctor/available-dates");if(404===e.status)return void re([]);if(e.status>=400)return void re([]);const r=Array.isArray(e.data)?e.data:[];re(r)}catch(e){re([])}},[]);e.useEffect(()=>{se&&($(!0),ne(),le(),de())},[se,ne,le,de]);const oe=e.useMemo(()=>L?N.filter(e=>{let r=!0;r="all"!==B?e.status===B:["pending","approved"].includes(e.status);const a=j(e,m.get(e.id)),t=a.full_name||"",s=e.doctor_service?.name||"",n=a.phone_number||"",l=t.toLowerCase().includes(P.toLowerCase())||s.toLowerCase().includes(P.toLowerCase())||n.includes(P);return r&&l}):[],[N,B,P,L]),ie=e.useMemo(()=>Math.ceil(oe.length/5),[oe.length]),ce=e.useMemo(()=>{const e=5*(q-1),r=e+5;return oe.slice(e,r)},[oe,q]),ge=e=>{switch(e){case"pending":return r("reservations.status.pending");case"approved":return r("reservations.status.approved");case"cancelled":return r("reservations.status.cancelled");case"completed":return r("reservations.status.completed");case"rejected":return r("reservations.status.rejected");default:return e}},ue=e=>{switch(e){case"pending":return"bg-warning/10 text-warning dark:bg-warning/20 dark:text-warning-light";case"approved":return"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light";case"cancelled":return"bg-danger/10 text-danger dark:bg-danger/20 dark:text-danger-light";case"completed":return"bg-success/10 text-success dark:bg-success/20 dark:text-success-light";case"rejected":return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}},me=(e,r)=>{D({message:e,type:r}),setTimeout(()=>D(null),3e3)};return S||!L?t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx(i,{size:"lg"})}):t.jsxs("div",{className:"space-y-6 relative",children:[t.jsx("div",{className:"flex justify-end gap-2",children:t.jsxs(c,{className:"",section:"bookings",size:"sm",onClick:()=>{W(!0),de()},children:["+ ",r("reservations.addManualReservation")]})}),A&&t.jsx("div",{className:"text-center text-red-500 py-2",children:A}),R&&t.jsx("div",{className:"text-center text-green-600 font-bold py-2",children:R}),F&&t.jsxs("div",{style:{position:"fixed",bottom:18,left:18,zIndex:99999,minWidth:120,maxWidth:220,padding:"7px 16px 7px 10px",borderRadius:"8px",background:"success"===F.type?"#22c55e":"#ef4444",color:"#fff",fontWeight:500,fontSize:"0.85rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",display:"flex",alignItems:"center",gap:7,pointerEvents:"none",userSelect:"none"},children:[t.jsx("span",{style:{fontSize:"1.1em",marginRight:6,display:"flex",alignItems:"center"},children:"success"===F.type?"âœ”ï¸":"âš ï¸"}),t.jsx("span",{style:{flex:1},children:F.message})]}),t.jsx(y,{open:U,onOpenChange:W,title:r("reservations.addManualReservation"),description:r("reservations.addReservationDesc"),children:t.jsxs("form",{className:"space-y-3",onSubmit:async e=>{if(e.preventDefault(),T(null),E(null),!ae.gender)return E(r("reservations.selectGender")),void me(r("reservations.selectGender"),"error");if(!ae.doctor_service_id)return E(r("reservations.selectService")),void me(r("reservations.selectService"),"error");if(!(ae.full_name&&ae.age&&ae.phone_number&&ae.date&&ae.start_time&&ae.end_time))return E(r("reservations.fillAllFields")),void me(r("reservations.fillAllFields"),"error");if(ee.length>0&&!ee.includes(ae.date))return E(r("reservations.dateNotAvailable")),void me(r("reservations.dateNotAvailable"),"error");if(ae.start_time>=ae.end_time)return E(r("reservations.startTimeMustBeLess")),void me(r("reservations.startTimeMustBeLess"),"error");const a=parseInt(ae.start_time.split(":")[0]),t=parseInt(ae.end_time.split(":")[0]);if(a<6||a>22)return E(r("reservations.startTimeRange")),void me(r("reservations.startTimeRange"),"error");if(t<6||t>23)return E(r("reservations.endTimeRange")),void me(r("reservations.endTimeRange"),"error");const s=new Date(ae.date),n=new Date;if(n.setHours(0,0,0,0),s<n)return E(r("reservations.cannotBookPast")),void me(r("reservations.cannotBookPast"),"error");try{const e={full_name:ae.full_name,age:ae.age,phone_number:ae.phone_number,doctor_service_id:ae.doctor_service_id,date:ae.date,start_time:ae.start_time,end_time:ae.end_time,notes:ae.notes,gender:ae.gender},a=await u.post("/api/doctor/reservations",e);if(a.status>=400){let e=a.data?.message||r("reservations.addError");if(409===a.status){const t=a.data?.message;e=t||r("reservations.slotAlreadyBooked")}else if(422===a.status){const t=a.data?.errors;if(t?.date)e=r("reservations.dateMustBeTodayOrFuture");else if(t){const r=Object.values(t)[0];e=Array.isArray(r)?r[0]:r}else e=r("reservations.invalidData")}else 404===a.status&&(e=r("reservations.serviceNotFound"));return E(e),void me(e,"error")}const t=a.data&&"object"==typeof a.data&&!Array.isArray(a.data)&&a.data.data?a.data.data:a.data;if(t&&!t.status&&(t.status="pending"),t&&t.id){const e={full_name:ae.full_name,phone_number:ae.phone_number,age:ae.age,gender:ae.gender,notes:ae.notes};if(m.save(t.id,e),!t.doctor_service&&ae.doctor_service_id){const e=_.find(e=>e.id==ae.doctor_service_id);e&&(t.doctor_service=e)}w(e=>[...e,t]),setTimeout(async()=>{await ne()},500)}me(r("reservations.addSuccess"),"success"),W(!1),te({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""})}catch(l){let e=l?.response?.data?.message||r("reservations.addError");if(422===l?.response?.status){const a=l?.response?.data?.errors;if(a?.date)e=r("reservations.dateMustBeTodayOrFuture");else if(a){const r=Object.values(a)[0];e=Array.isArray(r)?r[0]:r}else e=r("reservations.invalidData")}else if(409===l?.response?.status){const a=l?.response?.data?.message;e=a||r("reservations.slotAlreadyBooked")}else 400===l?.response?.status?e=r("reservations.badRequest"):500===l?.response?.status?e=r("reservations.serverError"):0!==l?.response?.status&&"NETWORK_ERROR"!==l?.code||(e=r("reservations.networkError"));E(e),me(e,"error")}},children:[t.jsx("div",{className:"space-y-2",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"full_name",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),r("reservations.fullName")]}),t.jsx(g,{id:"full_name",placeholder:r("reservations.fullNamePlaceholder"),value:ae.full_name,onChange:e=>te(r=>({...r,full_name:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all text-sm"})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"age",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),r("profile.age")]}),t.jsx(g,{id:"age",type:"number",placeholder:r("profile.agePlaceholder")||r("profile.age"),value:ae.age,onChange:e=>te(r=>({...r,age:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-green-500 dark:focus:border-green-400 focus:ring-2 focus:ring-green-200 dark:focus:ring-green-800 transition-all text-sm"})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"phone_number",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),r("profile.phoneNumber")]}),t.jsx(g,{id:"phone_number",type:"tel",placeholder:r("profile.phoneNumberPlaceholder"),value:ae.phone_number,onChange:e=>te(r=>({...r,phone_number:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-purple-500 dark:focus:border-purple-400 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 transition-all text-sm"})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"doctor_service_id",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),r("services.serviceName")]}),t.jsx(v,{value:ae.doctor_service_id,onChange:e=>te(r=>({...r,doctor_service_id:e})),options:_.map(e=>({value:e.id,label:e.name})),size:N.length>8?"sm":N.length>4?"md":"lg"})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"gender",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full"}),r("profile.gender")," *"]}),t.jsx(h,{value:ae.gender,onChange:e=>te(r=>({...r,gender:e}))})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"date",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),r("reservations.date")]}),t.jsx(g,{id:"date",type:"date",value:ae.date,onChange:e=>te(r=>({...r,date:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-red-500 dark:focus:border-red-400 focus:ring-2 focus:ring-red-200 dark:focus:ring-red-800 transition-all text-sm"})]})]})}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"start_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),r("schedule.startTime")]}),t.jsx(g,{id:"start_time",type:"time",value:ae.start_time,onChange:e=>te(r=>({...r,start_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200 dark:focus:ring-indigo-800 transition-all text-sm"})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"end_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),r("reservations.endTime")]}),t.jsx(g,{id:"end_time",type:"time",value:ae.end_time,onChange:e=>te(r=>({...r,end_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-teal-500 dark:focus:border-teal-400 focus:ring-2 focus:ring-teal-200 dark:focus:ring-teal-800 transition-all text-sm"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"notes",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),r("reservations.notes")]}),t.jsx(g,{id:"notes",placeholder:r("reservations.notesPlaceholder"),value:ae.notes,onChange:e=>te(r=>({...r,notes:e.target.value})),className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-yellow-500 dark:focus:border-yellow-400 focus:ring-2 focus:ring-yellow-200 dark:focus:ring-yellow-800 transition-all text-sm"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[t.jsx(c,{type:"button",variant:"outline",onClick:()=>W(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:r("common.cancel")}),t.jsx(c,{type:"submit",className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg shadow-lg transition-all text-sm",children:r("reservations.addReservation")})]})]})}),V&&(()=>{const e=m.get(V.id),a=j(V,e);return t.jsxs(y,{open:H,onOpenChange:J,title:r("reservations.patientInfoTitle"),description:r("reservations.patientInfoDescription"),children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("reservations.fullName")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:a.full_name||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("profile.age")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:a.age?`${a.age} ${r("profile.years")}`:"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("profile.gender")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:"male"===a.gender?r("auth.register.male"):"female"===a.gender?r("auth.register.female"):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("profile.phoneNumber")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:a.phone_number||t.jsx("span",{className:"text-gray-400 dark:text-gray-500 italic",children:r("reservations.notAvailableOld")})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("services.serviceName")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.doctor_service?.name||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("reservations.date")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.date?new Date(V.date).toLocaleDateString("ar"===f.language?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric"}):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("schedule.startTime")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.start_time?k(V.start_time):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("reservations.endTime")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:V.end_time?k(V.end_time):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("reservations.statusLabel")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ue(V.status)}`,children:ge(V.status)})})]})]}),V.notes&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:r("reservations.notes")}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm min-h-[60px]",children:V.notes})]})]}),t.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:t.jsx(c,{type:"button",variant:"outline",onClick:()=>J(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:r("reservations.close")})})]})})(),Y&&t.jsxs(y,{open:K,onOpenChange:Q,title:r("reservations.changeStatus"),description:r("reservations.selectNewStatus"),children:[t.jsx("div",{className:"space-y-3",children:[{value:"pending",label:r("reservations.status.pending"),icon:"â³",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",borderColor:"border-yellow-300 dark:border-yellow-700"},{value:"approved",label:r("reservations.status.approved"),icon:"âœ…",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",borderColor:"border-blue-300 dark:border-blue-700"},{value:"completed",label:r("reservations.status.completed"),icon:"âœ”ï¸",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",borderColor:"border-green-300 dark:border-green-700"},{value:"cancelled",label:r("reservations.status.cancelled"),icon:"âŒ",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",borderColor:"border-red-300 dark:border-red-700"},{value:"rejected",label:r("reservations.status.rejected"),icon:"â›”",color:"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400",borderColor:"border-gray-300 dark:border-gray-700"}].map(e=>t.jsxs("button",{onClick:()=>{(async(e,a)=>{T(null),E(null);const t=[...N];w(r=>r.map(r=>r.id===e?{...r,status:a}:r));try{const s=await u.patch(`/api/doctor/reservations/updateStatus/${e}`,{status:a},{headers:{"Content-Type":"application/json"}});if(s.status>=400){w(t);const e=s.data?.message||r("reservations.updateError");return E(e),void me(e,"error")}await ne();const n=m.get(e);!n||"completed"!==a&&"rejected"!==a||m.save(e,n),me(r("reservations.updateSuccess",{status:ge(a)}),"success")}catch(s){w(t);const e=s?.response?.data?.message||r("reservations.updateError");E(e),me(e,"error")}})(Y.id,e.value),Q(!1),Z(null)},className:`w-full px-4 py-3 rounded-lg border-2 ${e.borderColor} ${Y.status===e.value?`${e.color} font-bold shadow-md`:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700"} transition-all duration-200 flex items-center gap-3`,children:[t.jsx("span",{className:"text-2xl",children:e.icon}),t.jsx("span",{className:"text-base font-medium flex-1 text-right",children:e.label}),Y.status===e.value&&t.jsx("span",{className:"text-lg",children:"âœ“"})]},e.value))}),t.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700 mt-4",children:t.jsx(c,{type:"button",variant:"outline",onClick:()=>{Q(!1),Z(null)},className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:r("common.cancel")})})]}),t.jsxs(x,{children:[t.jsxs("div",{className:"flex-1 min-w-[180px]",children:[t.jsxs("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("common.search")," ",I!==P&&t.jsxs("span",{className:"text-xs text-gray-500",children:["(",r("common.searching"),")"]})]}),t.jsx(g,{id:"search",placeholder:r("reservations.searchPlaceholder"),value:I,onChange:e=>O(e.target.value),className:"dark:bg-zinc-800 dark:border-zinc-700 dark:text-gray-100 dark:placeholder:text-gray-400"})]}),t.jsx("div",{className:"flex-1 min-w-[140px]",children:t.jsx(b,{options:[{value:"all",label:r("reservations.allStatuses")},{value:"pending",label:r("reservations.status.pending")},{value:"approved",label:r("reservations.status.approved")},{value:"completed",label:r("reservations.status.completed")},{value:"rejected",label:r("reservations.status.rejected")}],value:B,onChange:M,placeholder:r("reservations.selectStatus"),className:"min-w-[140px]",section:"bookings",size:"sm"})}),t.jsx("div",{className:"flex items-end",children:t.jsx(c,{onClick:()=>{O(""),M("all")},section:"bookings",size:"sm",className:"w-full",children:r("common.reset")})})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-6",children:[t.jsx(p,{icon:t.jsx(s,{className:"text-primary dark:text-primary-light"}),label:r("reservations.totalReservations"),value:oe.length,color:"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light"}),t.jsx(p,{icon:t.jsx(n,{className:"text-warning dark:text-warning-light"}),label:r("reservations.status.pending"),value:oe.filter(e=>"pending"===e.status).length,color:"bg-warning/10 text-warning dark:bg-warning/20 dark:text-warning-light"}),t.jsx(p,{icon:t.jsx(l,{className:"text-green-600 dark:text-green-400"}),label:r("reservations.status.approved"),value:oe.filter(e=>"approved"===e.status).length,color:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400"})]}),ce.length>0?t.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-white dark:bg-zinc-900 shadow-xl dark:shadow-2xl border border-gray-100 dark:border-zinc-800 fade-in pb-4",style:{marginBottom:"50px"},children:t.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[80vh] custom-scrollbar",children:t.jsxs("table",{className:"min-w-full divide-y-0",children:[t.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-zinc-800 dark:to-zinc-800/90 sticky top-0 z-10 border-b-2 border-blue-200 dark:border-zinc-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),t.jsx("span",{children:r("reservations.columns.patient")})]})}),t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),t.jsx("span",{children:r("reservations.columns.contact")})]})}),t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),t.jsx("span",{children:r("reservations.columns.service")})]})}),t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),t.jsx("span",{children:r("reservations.columns.appointment")})]})}),t.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),t.jsx("span",{children:r("reservations.columns.status")})]})}),t.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:r("services.actions")})]})}),t.jsx("tbody",{className:"divide-y-2 divide-gray-100 dark:divide-zinc-800",children:ce.map((e,a)=>{const s=m.get(e.id),n=j(e,s);return t.jsxs("tr",{className:"group transition-all duration-200 hover:bg-blue-50 dark:hover:bg-zinc-800 "+(a%2==0?"bg-white dark:bg-zinc-900":"bg-gray-100 dark:bg-zinc-800/80"),children:[t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg text-sm",children:(n.full_name||r("reservations.defaultInitial"))[0].toUpperCase()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 truncate mb-1",children:n.full_name||"-"}),t.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1.5",children:["male"===n.gender?"ðŸ‘¨":"female"===n.gender?"ðŸ‘©":"ðŸ‘¤",t.jsx("span",{children:n.age?`${n.age} ${r("profile.years")}`:"-"})]})]})]})}),t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-sm",children:t.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"ðŸ“±"})}),n.phone_number?t.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 dir-ltr",children:n.phone_number}):t.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 italic",children:r("reservations.notAvailable")})]})}),t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-sm",children:t.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"ðŸ¥"})}),t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e.doctor_service?.name||"-"})]})}),t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-900 dark:text-gray-100",children:[t.jsx("span",{className:"text-green-600 dark:text-green-400",children:"ðŸ“…"}),t.jsx("span",{children:e.date?new Date(e.date).toLocaleDateString("ar"===f.language?"ar-EG":"en-US",{month:"short",day:"numeric"}):"-"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:"â°"}),t.jsx("span",{className:"font-mono",children:e.start_time?k(e.start_time):"-"}),t.jsx("span",{children:"â†’"}),t.jsx("span",{className:"font-mono",children:e.end_time?k(e.end_time):"-"})]})]})}),t.jsx("td",{className:"px-6 py-5 text-center",children:t.jsxs("span",{className:`inline-flex items-center gap-1.5 px-4 py-2 rounded-full text-xs font-bold shadow-sm ${ue(e.status)} transition-all duration-200 hover:scale-105`,children:[t.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-pulse"}),ge(e.status)]})}),t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs("button",{onClick:()=>{const r=m.get(e.id);j(e,r),X(e),J(!0)},className:"group/btn relative w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200",title:r("reservations.viewPatientInfo"),children:[t.jsx(d,{size:18,className:"relative z-10"}),t.jsx("div",{className:"absolute inset-0 rounded-xl bg-white opacity-0 group-hover/btn:opacity-20 transition-opacity"})]}),t.jsx("button",{onClick:()=>{Z(e),Q(!0)},className:"group/status w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 dark:from-zinc-700 dark:to-zinc-800 dark:hover:from-zinc-600 dark:hover:to-zinc-700 shadow-md hover:shadow-lg transform hover:scale-110 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:r("reservations.changeStatus"),children:t.jsx("span",{className:"text-lg",children:"âš™ï¸"})})]})})]},e.id)})})]})})}):t.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-zinc-900 dark:to-zinc-800 border-2 border-dashed border-blue-300 dark:border-zinc-700 p-12 text-center fade-in",style:{marginBottom:"60px"},children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/20 rounded-full -mr-16 -mt-16 opacity-50"}),t.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-indigo-200 dark:bg-indigo-900/20 rounded-full -ml-20 -mb-20 opacity-50"}),t.jsxs("div",{className:"relative z-10 space-y-4",children:[t.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-4xl",children:"ðŸ“‹"}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:r("reservations.noReservations")}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:r("reservations.noReservationsFound")}),t.jsxs(c,{onClick:()=>{W(!0),de()},section:"bookings",className:"mt-4",children:["+ ",r("reservations.addNewReservation")]})]})]}),ie>1&&t.jsxs("div",{className:"flex justify-center gap-4",children:[t.jsx(c,{variant:"outline",onClick:()=>G(e=>Math.max(e-1,1)),disabled:1===q,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:r("common.previous")}),t.jsx("span",{className:"flex items-center px-4 text-gray-700 dark:text-gray-300",children:r("reservations.pageInfo",{current:q,total:ie})}),t.jsx(c,{variant:"outline",onClick:()=>G(e=>Math.min(e+1,ie)),disabled:q===ie,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:r("common.next")})]})]})});function k(e){if(!e)return"-";const[r,a]=e.split(":");return`${r}:${a}`}function j(e,r){if(r)return{full_name:r.full_name||e.full_name||e.user?.account?.full_name||e.user?.full_name||"",phone_number:r.phone_number||e.phone_number||e.user?.account?.phone_number||e.user?.phone_number||"",age:r.age||e.age||e.user?.age||"",gender:r.gender||e.gender||e.user?.gender||""};if(e.full_name&&e.phone_number)return{full_name:e.full_name,phone_number:e.phone_number,age:e.age||"",gender:e.gender||""};const a=e.user?.account?.phone_number||e.user?.phone_number||e.user?.account?.phone||e.user?.phone||e.phone_number||e.phone||e.mobile||e.user?.mobile||e.user?.account?.mobile||e.user?.contact_number||e.contact_number||e.user?.telephone||e.telephone||"";return{full_name:e.user?.account?.full_name||e.user?.full_name||"",phone_number:a,age:e.user?.age||e.age||"",gender:e.user?.gender||e.gender||""}}export{f as default};
