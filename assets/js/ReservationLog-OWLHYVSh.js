import{n as e,r,j as t,e as s,d as a,w as l,I as n}from"./react-vendor-DWMGvGTO.js";import{L as d,d as i,B as c}from"./index-Bn4zpa56.js";import{a as o,b as x,c as m,d as g}from"./index-Cbt-g0jB.js";import{S as u,F as h,D as p,a as b}from"./DropdownFilterButton-BtmegiFH.js";import{b as j}from"./axios-lBo-y8w0.js";import"./vendor-SX7gLFj9.js";import"./i18n-vendor-aVkm1h7f.js";import"./animation-vendor-DtfVNoxx.js";import"./api.config-kPv0EHGZ.js";import"./http-vendor-vzM7rUwp.js";const f=()=>{const{t:f,i18n:N}=e(),[k,w]=r.useState([]),[_,z]=r.useState(!0),[S,C]=r.useState("all"),[L,$]=r.useState("all"),[A,D]=r.useState(""),[E,I]=r.useState(1),[B,F]=r.useState(null),[U,M]=r.useState(!1),[P,T]=r.useState(!1);r.useEffect(()=>{T(!0),G()},[]),r.useEffect(()=>{const e=()=>{G()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]);const G=async()=>{z(!0);try{const e=(await j.get("/api/doctor/reservations")).data,r=Array.isArray(e)?e:Array.isArray(e.data)?e.data:[];w(r)}catch(e){w([])}finally{z(!1)}},H=P?k.filter(e=>{const r=["completed","rejected"].includes(e.status)&&("all"===S||e.status===S),t="all"===L||e.date&&e.date.includes(L),s=v(e,u.get(e.id)),a=(s.full_name||"").toLowerCase().includes(A.toLowerCase())||(e.doctor_service?.name||"").toLowerCase().includes(A.toLowerCase())||(s.phone_number||"").includes(A);return r&&t&&a}):[],O=Math.ceil(H.length/5),R=5*(E-1),q=R+5,J=H.slice(R,q),K=e=>{switch(e){case"completed":return f("reservations.status.completed");case"cancelled":return f("reservations.status.cancelled");case"rejected":return f("reservations.status.rejected");default:return e}},Q=e=>{switch(e){case"completed":return"bg-success/10 text-success dark:bg-success/20 dark:text-success-light";case"cancelled":return"bg-danger/10 text-danger dark:bg-danger/20 dark:text-danger-light";case"rejected":return"bg-red-100 text-red-600 dark:bg-red-900 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}},V=k.filter(e=>"completed"===e.status).length,W=k.filter(e=>"rejected"===e.status).length,X=k.filter(e=>"completed"===e.status&&e.doctor_service?.price).reduce((e,r)=>e+Number(r.doctor_service?.price||0),0);return _||!P?t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx(d,{size:"lg"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs(h,{children:[t.jsxs("div",{className:"flex-1 min-w-[180px]",children:[t.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:f("common.search")}),t.jsx(i,{id:"search",placeholder:f("history.searchPlaceholder"),value:A,onChange:e=>D(e.target.value),className:"dark:bg-zinc-800 dark:border-zinc-700 dark:text-gray-100 dark:placeholder:text-gray-400"})]}),t.jsx(p,{options:[{value:"all",label:f("history.allStatuses")},{value:"completed",label:f("history.completedStatus")},{value:"rejected",label:f("reservations.status.rejected")}],value:S,onChange:C,placeholder:f("reservations.selectStatus"),className:"min-w-[140px]",section:"history",size:"sm"}),t.jsx("div",{className:"flex-1 min-w-[140px]",children:t.jsx(i,{placeholder:f("history.searchByDate"),value:"all"===L?"":L,onChange:e=>$(e.target.value||"all"),className:"dark:bg-zinc-800 dark:border-zinc-700 dark:text-gray-100 dark:placeholder:text-gray-400"})}),t.jsx("div",{className:"flex items-end",children:t.jsx(c,{onClick:()=>{D(""),C("all"),$("all")},section:"history",size:"sm",variant:"outline",className:"w-full",children:f("common.reset")})})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-6",children:[t.jsx(b,{icon:t.jsx(s,{className:"text-green-600 dark:text-green-400"}),label:f("history.completedStatus"),value:V,color:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400"}),t.jsx(b,{icon:t.jsx(a,{className:"text-red-600 dark:text-red-400"}),label:f("reservations.status.rejected"),value:W,color:"bg-red-100 text-red-600 dark:bg-red-900 dark:text-red-400"}),t.jsx(b,{icon:t.jsx(l,{className:"text-primary dark:text-primary-light"}),label:f("reservations.totalRevenue"),value:`${X} ${f("reservations.currencyShort")}`,color:"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light"})]}),J.length>0?t.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-white dark:bg-zinc-900 shadow-xl dark:shadow-2xl border border-gray-100 dark:border-zinc-800 fade-in pb-6",style:{marginBottom:"50px"},children:t.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[80vh] custom-scrollbar",children:t.jsxs("table",{className:"min-w-full divide-y-0",children:[t.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-zinc-800 dark:to-zinc-800/90 sticky top-0 z-10 border-b-2 border-blue-200 dark:border-zinc-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),t.jsx("span",{children:f("history.columns.patient")})]})}),t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),t.jsx("span",{children:f("history.columns.service")})]})}),t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),t.jsx("span",{children:f("history.columns.dateAndTime")})]})}),t.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),t.jsx("span",{children:f("history.columns.durationAndPrice")})]})}),t.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),t.jsx("span",{children:f("history.columns.status")})]})})]})}),t.jsx("tbody",{className:"divide-y-2 divide-gray-100 dark:divide-zinc-800",children:J.map((e,r)=>{const s=u.get(e.id),a=v(e,s);return t.jsxs("tr",{className:"group transition-all duration-200 hover:bg-blue-50 dark:hover:bg-zinc-800 "+(r%2==0?"bg-white dark:bg-zinc-900":"bg-gray-100 dark:bg-zinc-800/80"),children:[t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg text-sm",children:(a.full_name||f("reservations.defaultInitial"))[0].toUpperCase()}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 truncate",children:a.full_name||"-"})}),t.jsx("button",{onClick:()=>(F(e),void M(!0)),className:"flex-shrink-0 p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-all duration-200 group",title:f("reservations.viewPatientInfo"),children:t.jsx(n,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform"})})]})}),t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-sm",children:t.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"ðŸ¥"})}),t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e.doctor_service?.name||"-"})]})}),t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-900 dark:text-gray-100",children:[t.jsx("span",{className:"text-green-600 dark:text-green-400",children:"ðŸ“…"}),t.jsx("span",{children:e.date?new Date(e.date).toLocaleDateString("ar"===N.language?"ar-EG":"en-US",{month:"short",day:"numeric"}):"-"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:"â°"}),t.jsx("span",{className:"font-mono",children:e.start_time?y(e.start_time):"-"}),t.jsx("span",{children:"â†’"}),t.jsx("span",{className:"font-mono",children:e.end_time?y(e.end_time):"-"})]})]})}),t.jsx("td",{className:"px-6 py-5",children:t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-900 dark:text-gray-100",children:[t.jsx("span",{children:"â±ï¸"}),t.jsx("span",{className:"font-medium",children:e.doctor_service?.duration_minutes?`${e.doctor_service.duration_minutes} ${f("services.minutes")}`:"-"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:"ðŸ’°"}),t.jsx("span",{className:"font-medium",children:e.doctor_service?.price?`${e.doctor_service.price} ${f("reservations.currencyShort")}`:"-"})]})]})}),t.jsx("td",{className:"px-6 py-5 text-center",children:t.jsxs("span",{className:`inline-flex items-center gap-1.5 px-4 py-2 rounded-full text-xs font-bold shadow-sm ${Q(e.status)} transition-all duration-200 hover:scale-105`,children:[t.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-pulse"}),K(e.status)]})})]},e.id)})})]})})}):t.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-zinc-900 dark:to-zinc-800 border-2 border-dashed border-blue-300 dark:border-zinc-700 p-12 text-center fade-in",style:{marginBottom:"55px"},children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/20 rounded-full -mr-16 -mt-16 opacity-50"}),t.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-indigo-200 dark:bg-indigo-900/20 rounded-full -ml-20 -mb-20 opacity-50"}),t.jsxs("div",{className:"relative z-10 space-y-4",children:[t.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-4xl",children:"ðŸ“Š"}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:f("history.noHistory")}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:f("history.noHistoryFound")})]})]}),O>1&&t.jsxs("div",{className:"flex justify-center gap-4",children:[t.jsx(c,{variant:"outline",onClick:()=>I(e=>Math.max(e-1,1)),disabled:1===E,section:"history",size:"sm",className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:f("common.previous")}),t.jsx("span",{className:"flex items-center px-4 text-gray-700 dark:text-gray-300",children:f("history.pageInfo",{current:E,total:O})}),t.jsx(c,{variant:"outline",onClick:()=>I(e=>Math.min(e+1,O)),disabled:E===O,section:"history",size:"sm",className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:f("common.next")})]}),B&&(()=>{const e=u.get(B.id),r=v(B,e);return t.jsx(o,{open:U,onOpenChange:M,children:t.jsxs(x,{className:"sm:max-w-[500px] bg-white dark:bg-zinc-900 border-gray-200 dark:border-zinc-800",children:[t.jsx(m,{children:t.jsxs(g,{className:"text-xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg",children:(r.full_name||f("reservations.defaultInitial"))[0].toUpperCase()}),f("reservations.patientInfoTitle")]})}),t.jsxs("div",{className:"space-y-4 mt-4",children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-blue-200 dark:border-blue-800",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-blue-500 dark:bg-blue-600 flex items-center justify-center",children:t.jsx("span",{className:"text-white text-lg",children:"ðŸ‘¤"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f("reservations.fullName")}),t.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:r.full_name||"-"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-blue-200 dark:border-blue-800",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-green-500 dark:bg-green-600 flex items-center justify-center",children:t.jsx("span",{className:"text-white text-lg",children:"ðŸ“ž"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f("profile.phoneNumber")}),r.phone_number?t.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 dir-ltr text-right",children:r.phone_number}):t.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 italic text-right",children:f("history.notAvailableOld")})]})]}),t.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-blue-200 dark:border-blue-800",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-orange-500 dark:bg-orange-600 flex items-center justify-center",children:t.jsx("span",{className:"text-white text-lg",children:"ðŸ¥"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f("services.serviceName")}),t.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:B?.doctor_service?.name||"-"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-blue-200 dark:border-blue-800",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-purple-500 dark:bg-purple-600 flex items-center justify-center",children:t.jsx("span",{className:"text-white text-lg",children:"ðŸ“…"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f("reservations.date")}),t.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:B?.date?new Date(B.date).toLocaleDateString("ar"===N.language?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric"}):"-"})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-indigo-500 dark:bg-indigo-600 flex items-center justify-center",children:t.jsx("span",{className:"text-white text-lg",children:"â°"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f("history.columns.dateAndTime")}),t.jsxs("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 dir-ltr text-right",children:[B?.start_time?y(B.start_time):"-"," - ",B?.end_time?y(B.end_time):"-"]})]})]})]}),t.jsx("div",{className:"flex justify-end pt-2",children:t.jsx(c,{onClick:()=>M(!1),variant:"outline",className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:f("common.close")})})]})]})})})()]})};function y(e){if(!e)return"-";const[r,t]=e.split(":");return`${r}:${t}`}function v(e,r){if(r&&r.phone_number)return{full_name:r.full_name||e.user?.full_name||e.full_name||"",phone_number:r.phone_number||"",age:r.age||e.user?.age||e.age||"",gender:r.gender||e.user?.gender||e.gender||""};if(e.full_name&&e.phone_number)return{full_name:e.full_name,phone_number:e.phone_number,age:e.age||"",gender:e.gender||""};const t=e.user?.account?.phone_number||e.user?.phone_number||e.user?.phone||e.user?.account?.phone||e.phone_number||e.phone||e.mobile||e.user?.mobile||e.user?.account?.mobile||e.user?.contact_number||e.contact_number||e.user?.telephone||e.telephone||"";return{full_name:e.user?.account?.full_name||e.user?.full_name||"",phone_number:t,age:e.user?.age||e.age||"",gender:e.user?.gender||e.gender||""}}export{f as default};
