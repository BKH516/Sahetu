import{c as e,r,R as a,b as t,y as s,j as n,L as l,B as d,k as o,C as i}from"./index-eoxoubdi.js";import{b as c}from"./axios-5JVLD2nj.js";import{S as g,F as u,D as m,a as x}from"./DropdownFilterButton-RWxXEO7B.js";import{D as b}from"./index-CmkvhwIT.js";import{u as p,C as y}from"./clock-Buifvxvl.js";import{E as h}from"./eye-CI_Fa-kl.js";import"./trending-up-zuCbqvgv.js";import"./api.config-D-uymJF2.js";const v=e("chart-no-axes-column",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);function f({value:e,onChange:a}){const{t:t}=p(),[s,l]=r.useState(!1),d=r.useRef(null),o=[{value:"male",label:t("auth.register.male")},{value:"female",label:t("auth.register.female")}];return r.useEffect(()=>{function e(e){d.current&&!d.current.contains(e.target)&&l(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),n.jsxs("div",{className:"relative w-full",ref:d,children:[n.jsxs("button",{type:"button",className:"w-full px-3 py-2 border-2 border-pink-400 dark:border-pink-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-pink-300 dark:focus:ring-pink-700 transition",onClick:()=>l(e=>!e),children:[o.find(r=>r.value===e)?.label||t("reservations.selectGender"),n.jsx("span",{className:"float-left",children:s?"â–²":"â–¼"})]}),s&&n.jsx("div",{className:"absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-pink-400 dark:border-pink-600 rounded-lg shadow-lg text-sm max-h-[20vh] overflow-y-auto mt-2",children:o.map(r=>n.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-pink-50 dark:hover:bg-pink-900/30 text-gray-900 dark:text-gray-100 "+(e===r.value?"bg-pink-100 dark:bg-pink-900/50 font-bold":""),onClick:()=>{a(r.value),l(!1)},children:r.label},r.value))})]})}function k({value:e,onChange:a,options:t,forceDropUp:s=!1,size:l="md"}){const{t:d}=p(),[o,i]=r.useState(!1),c=r.useRef(null),g=r.useRef(null);r.useEffect(()=>{function e(e){c.current&&!c.current.contains(e.target)&&i(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let u="w-full px-3 py-2 text-sm",m="text-sm min-w-[120px]";"sm"===l?(u="w-full px-2 py-1.5 text-xs",m="text-xs min-w-[100px]"):"lg"===l&&(u="w-full px-4 py-3 text-base",m="text-base min-w-[160px]");const x=t.find(r=>r.value===e)?.label||d("reservations.selectService");return n.jsxs("div",{className:"relative",ref:c,style:{width:"100%"},children:[n.jsxs("button",{type:"button",ref:g,className:u+" border-2 border-orange-400 dark:border-orange-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 font-medium focus:outline-none focus:ring-2 focus:ring-orange-300 dark:focus:ring-orange-700 transition",onClick:()=>i(e=>!e),style:{width:"100%"},children:[x,n.jsx("span",{className:"float-left",children:o?"â–²":"â–¼"})]}),o&&n.jsx("div",{className:`absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-orange-400 dark:border-orange-600 rounded-lg shadow-lg ${m} max-h-[25vh] overflow-y-auto mt-2`+(s?" bottom-full mb-2 mt-0":""),children:t.map(r=>n.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-orange-50 dark:hover:bg-orange-900/30 text-gray-900 dark:text-gray-100 "+(e===r.value?"bg-orange-100 dark:bg-orange-900/50 font-bold":""),onClick:()=>{a(r.value),i(!1)},children:r.label},r.value))})]})}const j=a.memo(()=>{const{t:e,i18n:a}=p(),[j,_]=r.useState([]),[C,S]=r.useState([]),[z,E]=r.useState(!0),[R,A]=r.useState(null),[T,F]=r.useState(null),[L,D]=r.useState(null),[M,I]=r.useState(!1),[O,$]=r.useState("all"),[B,P]=r.useState(""),q=function(e,a=500){const[t,s]=r.useState(e);return r.useEffect(()=>{const r=setTimeout(()=>{s(e)},a);return()=>{clearTimeout(r)}},[e,a]),t}(B,300),[G,U]=r.useState(1),[V,W]=r.useState(!1),[H,K]=r.useState(!1),[J,Q]=r.useState(!1),[X,Y]=r.useState(null),[Z,ee]=r.useState(null),[re,ae]=r.useState([]),[te,se]=r.useState({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""}),{isAuthenticated:ne}=t(),{showInfo:le}=s(),de=r.useRef([]),oe=r.useCallback(async({silent:r=!1,notifyOnNew:a=!1}={})=>{r||E(!0),A(null);try{const r=await c.get("/api/doctor/reservations");if(r.status>=400){const a=r.data?.message||e("reservations.loadError");return A(a),void _([])}const t=r.data,s=Array.isArray(t)?t:Array.isArray(t.data)?t.data:[];if(a&&de.current.length>0){const r=new Set(de.current.map(e=>e.id)),a=s.filter(e=>!r.has(e.id));if(a.length>0){const r=a[0],t=w(r,g.get(r.id)).full_name||e("reservations.patientUnknown",{defaultValue:"Ù…Ø±ÙŠØ¶"}),s=e("reservations.newReservationTitle",{defaultValue:"Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯"}),n=1===a.length?e("reservations.newReservationMessageSingle",{defaultValue:"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯.",name:t}):e("reservations.newReservationMessageMultiple",{defaultValue:"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… {{count}} Ø­Ø¬ÙˆØ²Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©.",count:a.length});le(s,n,{duration:7e3})}}de.current=s,_(s)}catch(t){const r=t instanceof Error?t.message:e("reservations.loadError");A(r)}finally{r||E(!1)}},[e,le]),ie=r.useCallback(async()=>{try{const r=await c.get("/api/doctor/services");if(r.status>=400){const a=r.data?.message||e("services.loadingError");return A(a),void S([])}const a=r.data,t=Array.isArray(a)?a:Array.isArray(a.data)?a.data:[];S(t)}catch(r){const a=r instanceof Error?r.message:e("services.loadingError");A(a),S([])}finally{E(!1)}},[e]),ce=r.useCallback(async()=>{try{const e=await c.get("/api/doctor/available-dates");if(404===e.status)return void ae([]);if(e.status>=400)return void ae([]);const r=Array.isArray(e.data)?e.data:[];ae(r)}catch(e){ae([])}},[]);r.useEffect(()=>{ne&&(I(!0),oe(),ie(),ce())},[ne,oe,ie,ce]),r.useEffect(()=>{if(!ne)return;let e=!document.hidden;const r=()=>{e=!document.hidden,e&&oe({silent:!0,notifyOnNew:!0})};document.addEventListener("visibilitychange",r);const a=setInterval(()=>{e&&!document.hidden&&oe({silent:!0,notifyOnNew:!0})},2e4);return()=>{document.removeEventListener("visibilitychange",r),clearInterval(a)}},[ne,oe]);const ge=r.useMemo(()=>M?j.filter(e=>{let r=!0;r="all"!==O?e.status===O:["pending","approved"].includes(e.status);const a=w(e,g.get(e.id)),t=a.full_name||"",s=e.doctor_service?.name||"",n=a.phone_number||"",l=t.toLowerCase().includes(q.toLowerCase())||s.toLowerCase().includes(q.toLowerCase())||n.includes(q);return r&&l}):[],[j,O,q,M]),ue=r.useMemo(()=>Math.ceil(ge.length/5),[ge.length]),me=r.useMemo(()=>{const e=5*(G-1),r=e+5;return ge.slice(e,r)},[ge,G]),xe=r=>{switch(r){case"pending":return e("reservations.status.pending");case"approved":return e("reservations.status.approved");case"cancelled":return e("reservations.status.cancelled");case"completed":return e("reservations.status.completed");case"rejected":return e("reservations.status.rejected");default:return r}},be=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300";case"approved":return"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light";case"cancelled":return"bg-danger/10 text-danger dark:bg-danger/20 dark:text-danger-light";case"completed":return"bg-success/10 text-success dark:bg-success/20 dark:text-success-light";case"rejected":return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}},pe=(e,r)=>{D({message:e,type:r}),setTimeout(()=>D(null),3e3)};return z||!M?n.jsx("div",{className:"flex justify-center items-center h-64",children:n.jsx(l,{size:"lg"})}):n.jsxs("div",{className:"space-y-6 relative",children:[n.jsx("div",{className:"flex justify-end gap-2",children:n.jsxs(d,{className:"",section:"bookings",size:"sm",onClick:()=>{W(!0),ce()},children:["+ ",e("reservations.addManualReservation")]})}),R&&n.jsx("div",{className:"text-center text-red-500 py-2",children:R}),T&&n.jsx("div",{className:"text-center text-green-600 font-bold py-2",children:T}),L&&n.jsxs("div",{style:{position:"fixed",bottom:18,left:18,zIndex:99999,minWidth:120,maxWidth:220,padding:"7px 16px 7px 10px",borderRadius:"8px",background:"success"===L.type?"#22c55e":"#ef4444",color:"#fff",fontWeight:500,fontSize:"0.85rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",display:"flex",alignItems:"center",gap:7,pointerEvents:"none",userSelect:"none"},children:[n.jsx("span",{style:{fontSize:"1.1em",marginRight:6,display:"flex",alignItems:"center"},children:"success"===L.type?"âœ”ï¸":"âš ï¸"}),n.jsx("span",{style:{flex:1},children:L.message})]}),n.jsx(b,{open:V,onOpenChange:W,title:e("reservations.addManualReservation"),description:e("reservations.addReservationDesc"),children:n.jsxs("form",{className:"space-y-3",onSubmit:async r=>{if(r.preventDefault(),F(null),A(null),!te.gender)return A(e("reservations.selectGender")),void pe(e("reservations.selectGender"),"error");if(!te.doctor_service_id)return A(e("reservations.selectService")),void pe(e("reservations.selectService"),"error");if(!(te.full_name&&te.age&&te.phone_number&&te.date&&te.start_time&&te.end_time))return A(e("reservations.fillAllFields")),void pe(e("reservations.fillAllFields"),"error");if(re.length>0&&!re.includes(te.date))return A(e("reservations.dateNotAvailable")),void pe(e("reservations.dateNotAvailable"),"error");if(te.start_time>=te.end_time)return A(e("reservations.startTimeMustBeLess")),void pe(e("reservations.startTimeMustBeLess"),"error");const a=parseInt(te.start_time.split(":")[0]),t=parseInt(te.end_time.split(":")[0]);if(a<6||a>22)return A(e("reservations.startTimeRange")),void pe(e("reservations.startTimeRange"),"error");if(t<6||t>23)return A(e("reservations.endTimeRange")),void pe(e("reservations.endTimeRange"),"error");const s=new Date(te.date),n=new Date;if(n.setHours(0,0,0,0),s<n)return A(e("reservations.cannotBookPast")),void pe(e("reservations.cannotBookPast"),"error");try{const r={full_name:te.full_name,age:te.age,phone_number:te.phone_number,doctor_service_id:te.doctor_service_id,date:te.date,start_time:te.start_time,end_time:te.end_time,notes:te.notes,gender:te.gender},a=await c.post("/api/doctor/reservations",r);if(a.status>=400){let r=a.data?.message||e("reservations.addError");if(409===a.status){const t=a.data?.message;r=t||e("reservations.slotAlreadyBooked")}else if(422===a.status){const t=a.data?.errors;if(t?.date)r=e("reservations.dateMustBeTodayOrFuture");else if(t){const e=Object.values(t)[0];r=Array.isArray(e)?e[0]:e}else r=e("reservations.invalidData")}else 404===a.status&&(r=e("reservations.serviceNotFound"));return A(r),void pe(r,"error")}const t=a.data&&"object"==typeof a.data&&!Array.isArray(a.data)&&a.data.data?a.data.data:a.data;if(t&&!t.status&&(t.status="pending"),t&&t.id){const e={full_name:te.full_name,phone_number:te.phone_number,age:te.age,gender:te.gender,notes:te.notes};if(g.save(t.id,e),!t.doctor_service&&te.doctor_service_id){const e=C.find(e=>e.id==te.doctor_service_id);e&&(t.doctor_service=e)}_(e=>[...e,t]),setTimeout(async()=>{await oe()},500)}pe(e("reservations.addSuccess"),"success"),W(!1),se({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""})}catch(l){let r=l?.response?.data?.message||e("reservations.addError");if(422===l?.response?.status){const a=l?.response?.data?.errors;if(a?.date)r=e("reservations.dateMustBeTodayOrFuture");else if(a){const e=Object.values(a)[0];r=Array.isArray(e)?e[0]:e}else r=e("reservations.invalidData")}else if(409===l?.response?.status){const a=l?.response?.data?.message;r=a||e("reservations.slotAlreadyBooked")}else 400===l?.response?.status?r=e("reservations.badRequest"):500===l?.response?.status?r=e("reservations.serverError"):0!==l?.response?.status&&"NETWORK_ERROR"!==l?.code||(r=e("reservations.networkError"));A(r),pe(r,"error")}},children:[n.jsx("div",{className:"space-y-2",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"full_name",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e("reservations.fullName")]}),n.jsx(o,{id:"full_name",placeholder:e("reservations.fullNamePlaceholder"),value:te.full_name,onChange:e=>se(r=>({...r,full_name:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all text-sm"})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"age",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("profile.age")]}),n.jsx(o,{id:"age",type:"number",placeholder:e("profile.agePlaceholder")||e("profile.age"),value:te.age,onChange:e=>se(r=>({...r,age:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-green-500 dark:focus:border-green-400 focus:ring-2 focus:ring-green-200 dark:focus:ring-green-800 transition-all text-sm"})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"phone_number",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e("profile.phoneNumber")]}),n.jsx(o,{id:"phone_number",type:"tel",placeholder:e("profile.phoneNumberPlaceholder"),value:te.phone_number,onChange:e=>se(r=>({...r,phone_number:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-purple-500 dark:focus:border-purple-400 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 transition-all text-sm"})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"doctor_service_id",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e("services.serviceName")]}),n.jsx(k,{value:te.doctor_service_id,onChange:e=>se(r=>({...r,doctor_service_id:e})),options:C.map(e=>({value:e.id,label:e.name})),size:j.length>8?"sm":j.length>4?"md":"lg"})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"gender",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full"}),e("profile.gender")," *"]}),n.jsx(f,{value:te.gender,onChange:e=>se(r=>({...r,gender:e}))})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"date",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e("reservations.date")]}),n.jsx(o,{id:"date",type:"date",value:te.date,onChange:e=>se(r=>({...r,date:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-red-500 dark:focus:border-red-400 focus:ring-2 focus:ring-red-200 dark:focus:ring-red-800 transition-all text-sm"})]})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"start_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),e("schedule.startTime")]}),n.jsx(o,{id:"start_time",type:"time",value:te.start_time,onChange:e=>se(r=>({...r,start_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200 dark:focus:ring-indigo-800 transition-all text-sm"})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"end_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),e("reservations.endTime")]}),n.jsx(o,{id:"end_time",type:"time",value:te.end_time,onChange:e=>se(r=>({...r,end_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-teal-500 dark:focus:border-teal-400 focus:ring-2 focus:ring-teal-200 dark:focus:ring-teal-800 transition-all text-sm"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"notes",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e("reservations.notes")]}),n.jsx(o,{id:"notes",placeholder:e("reservations.notesPlaceholder"),value:te.notes,onChange:e=>se(r=>({...r,notes:e.target.value})),className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-yellow-500 dark:focus:border-yellow-400 focus:ring-2 focus:ring-yellow-200 dark:focus:ring-yellow-800 transition-all text-sm"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[n.jsx(d,{type:"button",variant:"outline",onClick:()=>W(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("common.cancel")}),n.jsx(d,{type:"submit",className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg shadow-lg transition-all text-sm",children:e("reservations.addReservation")})]})]})}),X&&(()=>{const r=g.get(X.id),t=w(X,r);return n.jsxs(b,{open:H,onOpenChange:K,title:e("reservations.patientInfoTitle"),description:e("reservations.patientInfoDescription"),children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.fullName")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.full_name||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.age")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.age?`${t.age} ${e("profile.years")}`:"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.gender")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:"male"===t.gender?e("auth.register.male"):"female"===t.gender?e("auth.register.female"):"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.phoneNumber")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.phone_number||n.jsx("span",{className:"text-gray-400 dark:text-gray-500 italic",children:e("reservations.notAvailableOld")})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("services.serviceName")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:X.doctor_service?.name||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.date")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:X.date?new Date(X.date).toLocaleDateString("ar"===a.language?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric"}):"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("schedule.startTime")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:X.start_time?N(X.start_time):"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.endTime")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:X.end_time?N(X.end_time):"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.statusLabel")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${be(X.status)}`,children:xe(X.status)})})]})]}),X.notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.notes")}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm min-h-[60px]",children:X.notes})]})]}),n.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:n.jsx(d,{type:"button",variant:"outline",onClick:()=>K(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("reservations.close")})})]})})(),Z&&n.jsxs(b,{open:J,onOpenChange:Q,title:e("reservations.changeStatus"),description:e("reservations.selectNewStatus"),children:[n.jsx("div",{className:"space-y-3",children:[{value:"pending",label:e("reservations.status.pending"),icon:"â³",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",borderColor:"border-yellow-300 dark:border-yellow-700"},{value:"approved",label:e("reservations.status.approved"),icon:"âœ…",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",borderColor:"border-blue-300 dark:border-blue-700"},{value:"completed",label:e("reservations.status.completed"),icon:"âœ”ï¸",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",borderColor:"border-green-300 dark:border-green-700"},{value:"cancelled",label:e("reservations.status.cancelled"),icon:"âŒ",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",borderColor:"border-red-300 dark:border-red-700"}].map(r=>n.jsxs("button",{onClick:()=>{(async(r,a)=>{F(null),A(null);const t=[...j];_(e=>e.map(e=>e.id===r?{...e,status:a}:e));try{const s=await c.patch(`/api/doctor/reservations/updateStatus/${r}`,{status:a},{headers:{"Content-Type":"application/json"}});if(s.status>=400){_(t);const r=s.data?.message||e("reservations.updateError");return A(r),void pe(r,"error")}await oe();const n=g.get(r);!n||"completed"!==a&&"rejected"!==a||g.save(r,n),pe(e("reservations.updateSuccess",{status:xe(a)}),"success")}catch(s){_(t);const r=s?.response?.data?.message||e("reservations.updateError");A(r),pe(r,"error")}})(Z.id,r.value),Q(!1),ee(null)},className:`w-full px-4 py-3 rounded-lg border-2 ${r.borderColor} ${Z.status===r.value?`${r.color} font-bold shadow-md`:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700"} transition-all duration-200 flex items-center gap-3`,children:[n.jsx("span",{className:"text-2xl",children:r.icon}),n.jsx("span",{className:"text-base font-medium flex-1 text-right",children:r.label}),Z.status===r.value&&n.jsx("span",{className:"text-lg",children:"âœ“"})]},r.value))}),n.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700 mt-4",children:n.jsx(d,{type:"button",variant:"outline",onClick:()=>{Q(!1),ee(null)},className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("common.cancel")})})]}),n.jsxs(u,{children:[n.jsxs("div",{className:"flex-1 min-w-[180px]",children:[n.jsxs("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e("common.search")," ",B!==q&&n.jsxs("span",{className:"text-xs text-gray-500",children:["(",e("common.searching"),")"]})]}),n.jsx(o,{id:"search",placeholder:e("reservations.searchPlaceholder"),value:B,onChange:e=>P(e.target.value),className:"dark:bg-zinc-800 dark:border-zinc-700 dark:text-gray-100 dark:placeholder:text-gray-400"})]}),n.jsx("div",{className:"flex-1 min-w-[140px]",children:n.jsx(m,{options:[{value:"all",label:e("reservations.allStatuses")},{value:"pending",label:e("reservations.status.pending")},{value:"approved",label:e("reservations.status.approved")},{value:"completed",label:e("reservations.status.completed")},{value:"cancelled",label:e("reservations.status.cancelled")}],value:O,onChange:$,placeholder:e("reservations.selectStatus"),className:"min-w-[140px]",section:"bookings",size:"sm"})}),n.jsx("div",{className:"flex items-end",children:n.jsx(d,{onClick:()=>{P(""),$("all")},section:"bookings",size:"sm",className:"w-full",children:e("common.reset")})})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-6",children:[n.jsx(x,{icon:n.jsx(v,{className:"text-primary dark:text-primary-light"}),label:e("reservations.totalReservations"),value:ge.length,color:"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light"}),n.jsx(x,{icon:n.jsx(y,{className:"text-yellow-600 dark:text-yellow-300"}),label:e("reservations.status.pending"),value:ge.filter(e=>"pending"===e.status).length,color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"}),n.jsx(x,{icon:n.jsx(i,{className:"text-green-600 dark:text-green-400"}),label:e("reservations.status.approved"),value:ge.filter(e=>"approved"===e.status).length,color:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400"})]}),me.length>0?n.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-white dark:bg-zinc-900 shadow-xl dark:shadow-2xl border border-gray-100 dark:border-zinc-800 fade-in pb-4",style:{marginBottom:"50px"},children:n.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[80vh] custom-scrollbar",children:n.jsxs("table",{className:"min-w-full divide-y-0",children:[n.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-zinc-800 dark:to-zinc-800/90 sticky top-0 z-10 border-b-2 border-blue-200 dark:border-zinc-700",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),n.jsx("span",{children:e("reservations.columns.patient")})]})}),n.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),n.jsx("span",{children:e("reservations.columns.contact")})]})}),n.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),n.jsx("span",{children:e("reservations.columns.service")})]})}),n.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),n.jsx("span",{children:e("reservations.columns.appointment")})]})}),n.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),n.jsx("span",{children:e("reservations.columns.status")})]})}),n.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:e("services.actions")})]})}),n.jsx("tbody",{className:"divide-y-2 divide-gray-100 dark:divide-zinc-800",children:me.map((r,t)=>{const s=g.get(r.id),l=w(r,s);return n.jsxs("tr",{className:"group transition-all duration-200 hover:bg-blue-50 dark:hover:bg-zinc-800 "+(t%2==0?"bg-white dark:bg-zinc-900":"bg-gray-100 dark:bg-zinc-800/80"),children:[n.jsx("td",{className:"px-6 py-5",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg text-sm",children:(l.full_name||e("reservations.defaultInitial"))[0].toUpperCase()}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 truncate mb-1",children:l.full_name||"-"}),n.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1.5",children:["male"===l.gender?"ðŸ‘¨":"female"===l.gender?"ðŸ‘©":"ðŸ‘¤",n.jsx("span",{children:l.age?`${l.age} ${e("profile.years")}`:"-"})]})]})]})}),n.jsx("td",{className:"px-6 py-5",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-sm",children:n.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"ðŸ“±"})}),l.phone_number?n.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 dir-ltr",children:l.phone_number}):n.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 italic",children:e("reservations.notAvailable")})]})}),n.jsx("td",{className:"px-6 py-5",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-sm",children:n.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"ðŸ¥"})}),n.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r.doctor_service?.name||"-"})]})}),n.jsx("td",{className:"px-6 py-5",children:n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-900 dark:text-gray-100",children:[n.jsx("span",{className:"text-green-600 dark:text-green-400",children:"ðŸ“…"}),n.jsx("span",{children:r.date?new Date(r.date).toLocaleDateString("ar"===a.language?"ar-EG":"en-US",{month:"short",day:"numeric"}):"-"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[n.jsx("span",{children:"â°"}),n.jsx("span",{className:"font-mono",children:r.start_time?N(r.start_time):"-"}),n.jsx("span",{children:"â†’"}),n.jsx("span",{className:"font-mono",children:r.end_time?N(r.end_time):"-"})]})]})}),n.jsx("td",{className:"px-6 py-5 text-center",children:n.jsxs("span",{className:`inline-flex items-center gap-1.5 px-4 py-2 rounded-full text-xs font-bold shadow-sm ${be(r.status)} transition-all duration-200 hover:scale-105`,children:[n.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-pulse"}),xe(r.status)]})}),n.jsx("td",{className:"px-6 py-5",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsxs("button",{onClick:()=>{const e=g.get(r.id);w(r,e),Y(r),K(!0)},className:"group/btn relative w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200",title:e("reservations.viewPatientInfo"),children:[n.jsx(h,{size:18,className:"relative z-10"}),n.jsx("div",{className:"absolute inset-0 rounded-xl bg-white opacity-0 group-hover/btn:opacity-20 transition-opacity"})]}),n.jsx("button",{onClick:()=>{ee(r),Q(!0)},className:"group/status w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 dark:from-zinc-700 dark:to-zinc-800 dark:hover:from-zinc-600 dark:hover:to-zinc-700 shadow-md hover:shadow-lg transform hover:scale-110 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:e("reservations.changeStatus"),children:n.jsx("span",{className:"text-lg",children:"âš™ï¸"})})]})})]},r.id)})})]})})}):n.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-zinc-900 dark:to-zinc-800 border-2 border-dashed border-blue-300 dark:border-zinc-700 p-12 text-center fade-in",style:{marginBottom:"60px"},children:[n.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/20 rounded-full -mr-16 -mt-16 opacity-50"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-indigo-200 dark:bg-indigo-900/20 rounded-full -ml-20 -mb-20 opacity-50"}),n.jsxs("div",{className:"relative z-10 space-y-4",children:[n.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-4xl",children:"ðŸ“‹"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:e("reservations.noReservations")}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:e("reservations.noReservationsFound")}),n.jsxs(d,{onClick:()=>{W(!0),ce()},section:"bookings",className:"mt-4",children:["+ ",e("reservations.addNewReservation")]})]})]}),ue>1&&n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsx(d,{variant:"outline",onClick:()=>U(e=>Math.max(e-1,1)),disabled:1===G,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:e("common.previous")}),n.jsx("span",{className:"flex items-center px-4 text-gray-700 dark:text-gray-300",children:e("reservations.pageInfo",{current:G,total:ue})}),n.jsx(d,{variant:"outline",onClick:()=>U(e=>Math.min(e+1,ue)),disabled:G===ue,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:e("common.next")})]})]})});function N(e){if(!e)return"-";const[r,a]=e.split(":");return`${r}:${a}`}function w(e,r){if(r)return{full_name:r.full_name||e.full_name||e.user?.account?.full_name||e.user?.full_name||"",phone_number:r.phone_number||e.phone_number||e.user?.account?.phone_number||e.user?.phone_number||"",age:r.age||e.age||e.user?.age||"",gender:r.gender||e.gender||e.user?.gender||""};if(e.full_name&&e.phone_number)return{full_name:e.full_name,phone_number:e.phone_number,age:e.age||"",gender:e.gender||""};const a=e.user?.account?.phone_number||e.user?.phone_number||e.user?.account?.phone||e.user?.phone||e.phone_number||e.phone||e.mobile||e.user?.mobile||e.user?.account?.mobile||e.user?.contact_number||e.contact_number||e.user?.telephone||e.telephone||"";return{full_name:e.user?.account?.full_name||e.user?.full_name||"",phone_number:a,age:e.user?.age||e.age||"",gender:e.user?.gender||e.gender||""}}export{j as default};
