import{c as e,r,R as a,a as t,d as s,z as n,o as l,k as d,j as o,L as i,B as c,q as g,C as u}from"./index-99IqcOUf.js";import{S as m,F as x,D as b,a as p}from"./DropdownFilterButton-Dpig8siC.js";import{D as y,L as h}from"./index-CYIOlG9_.js";import{C as v}from"./clock-sLeXm9or.js";import{E as f}from"./eye-BbcoWCjJ.js";import"./trending-up-Hy3b_itb.js";import"./user-kOcpVDJ_.js";const k=e("chart-no-axes-column",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);function j({value:e,onChange:a}){const{t:s}=t(),[n,l]=r.useState(!1),d=r.useRef(null),i=[{value:"male",label:s("auth.register.male")},{value:"female",label:s("auth.register.female")}];return r.useEffect(()=>{function e(e){d.current&&!d.current.contains(e.target)&&l(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),o.jsxs("div",{className:"relative w-full",ref:d,children:[o.jsxs("button",{type:"button",className:"w-full px-3 py-2 border-2 border-pink-400 dark:border-pink-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-pink-300 dark:focus:ring-pink-700 transition",onClick:()=>l(e=>!e),children:[i.find(r=>r.value===e)?.label||s("reservations.selectGender"),o.jsx("span",{className:"float-left",children:n?"â–²":"â–¼"})]}),n&&o.jsx("div",{className:"absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-pink-400 dark:border-pink-600 rounded-lg shadow-lg text-sm max-h-[20vh] overflow-y-auto mt-2",children:i.map(r=>o.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-pink-50 dark:hover:bg-pink-900/30 text-gray-900 dark:text-gray-100 "+(e===r.value?"bg-pink-100 dark:bg-pink-900/50 font-bold":""),onClick:()=>{a(r.value),l(!1)},children:r.label},r.value))})]})}function N({value:e,onChange:a,options:s,forceDropUp:n=!1,size:l="md"}){const{t:d}=t(),[i,c]=r.useState(!1),g=r.useRef(null),u=r.useRef(null);r.useEffect(()=>{function e(e){g.current&&!g.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let m="w-full px-3 py-2 text-sm",x="text-sm min-w-[120px]";"sm"===l?(m="w-full px-2 py-1.5 text-xs",x="text-xs min-w-[100px]"):"lg"===l&&(m="w-full px-4 py-3 text-base",x="text-base min-w-[160px]");const b=s.find(r=>r.value===e)?.label||d("reservations.selectService");return o.jsxs("div",{className:"relative",ref:g,style:{width:"100%"},children:[o.jsxs("button",{type:"button",ref:u,className:m+" border-2 border-orange-400 dark:border-orange-600 rounded-lg bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 font-medium focus:outline-none focus:ring-2 focus:ring-orange-300 dark:focus:ring-orange-700 transition",onClick:()=>c(e=>!e),style:{width:"100%"},children:[b,o.jsx("span",{className:"float-left",children:i?"â–²":"â–¼"})]}),i&&o.jsx("div",{className:`absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-orange-400 dark:border-orange-600 rounded-lg shadow-lg ${x} max-h-[25vh] overflow-y-auto mt-2`+(n?" bottom-full mb-2 mt-0":""),children:s.map(r=>o.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-orange-50 dark:hover:bg-orange-900/30 text-gray-900 dark:text-gray-100 "+(e===r.value?"bg-orange-100 dark:bg-orange-900/50 font-bold":""),onClick:()=>{a(r.value),c(!1)},children:r.label},r.value))})]})}const w=a.memo(()=>{const{t:e,i18n:a}=t(),[w,S]=r.useState([]),[z,E]=r.useState([]),[R,A]=r.useState(!0),[T,F]=r.useState(null),[L,D]=r.useState(null),[M,I]=r.useState(null),[O,$]=r.useState(!1),[B,q]=r.useState("all"),[P,G]=r.useState(""),U=function(e,a=500){const[t,s]=r.useState(e);return r.useEffect(()=>{const r=setTimeout(()=>{s(e)},a);return()=>{clearTimeout(r)}},[e,a]),t}(P,300),[V,W]=r.useState(1),[H,K]=r.useState(!1),[J,Q]=r.useState(!1),[X,Y]=r.useState(!1),[Z,ee]=r.useState(null),[re,ae]=r.useState(null),[te,se]=r.useState([]),[ne,le]=r.useState({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""}),{isAuthenticated:de}=s(),{showInfo:oe}=n(),{fetchNotifications:ie}=l(),[ce,ge]=r.useState(!1),[ue,me]=r.useState(null),xe=r.useRef([]),be=r.useCallback(async({silent:r=!1,notifyOnNew:a=!1}={})=>{r||A(!0),F(null);try{const r=await d.get("/api/doctor/reservations");if(r.status>=400){const a=r.data?.message||e("reservations.loadError");return F(a),void S([])}const t=r.data,s=Array.isArray(t)?t:Array.isArray(t.data)?t.data:[];if(a&&xe.current.length>0){const r=new Set(xe.current.map(e=>e.id)),a=s.filter(e=>!r.has(e.id));if(a.length>0){const r=a[0],t=C(r,m.get(r.id)).full_name||e("reservations.patientUnknown",{defaultValue:"Ù…Ø±ÙŠØ¶"}),s=e("reservations.newReservationTitle",{defaultValue:"Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯"}),n=1===a.length?e("reservations.newReservationMessageSingle",{defaultValue:"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯.",name:t}):e("reservations.newReservationMessageMultiple",{defaultValue:"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… {{count}} Ø­Ø¬ÙˆØ²Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©.",count:a.length});oe(s,n,{duration:7e3})}}xe.current=s,S(s)}catch(t){const r=t instanceof Error?t.message:e("reservations.loadError");F(r)}finally{r||A(!1)}},[e,oe]),pe=r.useCallback(async()=>{try{const r=await d.get("/api/doctor/services");if(r.status>=400){const a=r.data?.message||e("services.loadingError");return F(a),void E([])}const a=r.data,t=Array.isArray(a)?a:Array.isArray(a.data)?a.data:[];E(t)}catch(r){const a=r instanceof Error?r.message:e("services.loadingError");F(a),E([])}finally{A(!1)}},[e]),ye=r.useCallback(async()=>{try{const e=await d.get("/api/doctor/available-dates");if(404===e.status)return void se([]);if(e.status>=400)return void se([]);const r=Array.isArray(e.data)?e.data:[];se(r)}catch(e){se([])}},[]);r.useEffect(()=>{de&&($(!0),be(),pe(),ye())},[de,be,pe,ye]),r.useEffect(()=>{if(!de)return;let e=!document.hidden;const r=()=>{e=!document.hidden,e&&be({silent:!0,notifyOnNew:!0})};document.addEventListener("visibilitychange",r);const a=setInterval(()=>{e&&!document.hidden&&be({silent:!0,notifyOnNew:!0})},2e4);return()=>{document.removeEventListener("visibilitychange",r),clearInterval(a)}},[de,be]);const he=r.useMemo(()=>O?w.filter(e=>{let r=!0;r="all"!==B?e.status===B:["pending","approved"].includes(e.status);const a=C(e,m.get(e.id)),t=a.full_name||"",s=e.doctor_service?.name||"",n=a.phone_number||"",l=t.toLowerCase().includes(U.toLowerCase())||s.toLowerCase().includes(U.toLowerCase())||n.includes(U);return r&&l}):[],[w,B,U,O]),ve=r.useMemo(()=>Math.ceil(he.length/5),[he.length]),fe=r.useMemo(()=>{const e=5*(V-1),r=e+5;return he.slice(e,r)},[he,V]),ke=r=>{switch(r){case"pending":return e("reservations.status.pending");case"approved":return e("reservations.status.approved");case"cancelled":return e("reservations.status.cancelled");case"completed":return e("reservations.status.completed");case"rejected":return e("reservations.status.rejected");default:return r}},je=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300";case"approved":return"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light";case"cancelled":return"bg-danger/10 text-danger dark:bg-danger/20 dark:text-danger-light";case"completed":return"bg-success/10 text-success dark:bg-success/20 dark:text-success-light";case"rejected":return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}},Ne=(e,r)=>{I({message:e,type:r}),setTimeout(()=>I(null),3e3)};return R||!O?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx(i,{size:"lg"})}):o.jsxs("div",{className:"space-y-6 relative",children:[o.jsx("div",{className:"flex justify-end gap-2",children:o.jsxs(c,{className:"",section:"bookings",size:"sm",onClick:()=>{K(!0),ye()},children:["+ ",e("reservations.addManualReservation")]})}),T&&o.jsx("div",{className:"text-center text-red-500 py-2",children:T}),L&&o.jsx("div",{className:"text-center text-green-600 font-bold py-2",children:L}),M&&o.jsxs("div",{style:{position:"fixed",bottom:18,left:18,zIndex:99999,minWidth:120,maxWidth:220,padding:"7px 16px 7px 10px",borderRadius:"8px",background:"success"===M.type?"#22c55e":"#ef4444",color:"#fff",fontWeight:500,fontSize:"0.85rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",display:"flex",alignItems:"center",gap:7,pointerEvents:"none",userSelect:"none"},children:[o.jsx("span",{style:{fontSize:"1.1em",marginRight:6,display:"flex",alignItems:"center"},children:"success"===M.type?"âœ”ï¸":"âš ï¸"}),o.jsx("span",{style:{flex:1},children:M.message})]}),o.jsx(y,{open:H,onOpenChange:K,title:e("reservations.addManualReservation"),description:e("reservations.addReservationDesc"),children:o.jsxs("form",{className:"space-y-3",onSubmit:async r=>{if(r.preventDefault(),D(null),F(null),ce)return;if(!ne.gender)return F(e("reservations.selectGender")),void Ne(e("reservations.selectGender"),"error");if(!ne.doctor_service_id)return F(e("reservations.selectService")),void Ne(e("reservations.selectService"),"error");if(!(ne.full_name&&ne.age&&ne.phone_number&&ne.date&&ne.start_time&&ne.end_time))return F(e("reservations.fillAllFields")),void Ne(e("reservations.fillAllFields"),"error");if(te.length>0&&!te.includes(ne.date))return F(e("reservations.dateNotAvailable")),void Ne(e("reservations.dateNotAvailable"),"error");if(ne.start_time>=ne.end_time)return F(e("reservations.startTimeMustBeLess")),void Ne(e("reservations.startTimeMustBeLess"),"error");const a=parseInt(ne.start_time.split(":")[0]),t=parseInt(ne.end_time.split(":")[0]);if(a<6||a>22)return F(e("reservations.startTimeRange")),void Ne(e("reservations.startTimeRange"),"error");if(t<6||t>23)return F(e("reservations.endTimeRange")),void Ne(e("reservations.endTimeRange"),"error");const s=new Date(ne.date),n=new Date;if(n.setHours(0,0,0,0),s<n)return F(e("reservations.cannotBookPast")),void Ne(e("reservations.cannotBookPast"),"error");ge(!0);try{const r={full_name:ne.full_name,age:ne.age,phone_number:ne.phone_number,doctor_service_id:ne.doctor_service_id,date:ne.date,start_time:ne.start_time,end_time:ne.end_time,notes:ne.notes,gender:ne.gender},a=await d.post("/api/doctor/reservations",r);if(a.status>=400){let r=a.data?.message||e("reservations.addError");if(409===a.status){const t=a.data?.message;r=t||e("reservations.slotAlreadyBooked")}else if(422===a.status){const t=a.data?.errors;if(t?.date)r=e("reservations.dateMustBeTodayOrFuture");else if(t){const e=Object.values(t)[0];r=Array.isArray(e)?e[0]:e}else r=e("reservations.invalidData")}else 404===a.status&&(r=e("reservations.serviceNotFound"));return F(r),void Ne(r,"error")}const t=a.data&&"object"==typeof a.data&&!Array.isArray(a.data)&&a.data.data?a.data.data:a.data;if(t&&!t.status&&(t.status="pending"),t&&t.id){const e={full_name:ne.full_name,phone_number:ne.phone_number,age:ne.age,gender:ne.gender,notes:ne.notes};if(m.save(t.id,e),!t.doctor_service&&ne.doctor_service_id){const e=z.find(e=>e.id==ne.doctor_service_id);e&&(t.doctor_service=e)}S(e=>[...e,t]),setTimeout(async()=>{await be()},500)}Ne(e("reservations.addSuccess"),"success");try{await ie({silent:!0})}catch(l){}K(!1),le({full_name:"",age:"",phone_number:"",doctor_service_id:"",date:"",start_time:"",end_time:"",notes:"",gender:""})}catch(o){let r=o?.response?.data?.message||e("reservations.addError");if(422===o?.response?.status){const a=o?.response?.data?.errors;if(a?.date)r=e("reservations.dateMustBeTodayOrFuture");else if(a){const e=Object.values(a)[0];r=Array.isArray(e)?e[0]:e}else r=e("reservations.invalidData")}else if(409===o?.response?.status){const a=o?.response?.data?.message;r=a||e("reservations.slotAlreadyBooked")}else 400===o?.response?.status?r=e("reservations.badRequest"):500===o?.response?.status?r=e("reservations.serverError"):0!==o?.response?.status&&"NETWORK_ERROR"!==o?.code||(r=e("reservations.networkError"));F(r),Ne(r,"error")}finally{ge(!1)}},children:[o.jsx("div",{className:"space-y-2",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"full_name",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e("reservations.fullName")]}),o.jsx(g,{id:"full_name",placeholder:e("reservations.fullNamePlaceholder"),value:ne.full_name,onChange:e=>le(r=>({...r,full_name:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all text-sm"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"age",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("profile.age")]}),o.jsx(g,{id:"age",type:"number",placeholder:e("profile.agePlaceholder")||e("profile.age"),value:ne.age,onChange:e=>le(r=>({...r,age:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-green-500 dark:focus:border-green-400 focus:ring-2 focus:ring-green-200 dark:focus:ring-green-800 transition-all text-sm"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"phone_number",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e("profile.phoneNumber")]}),o.jsx(g,{id:"phone_number",type:"tel",placeholder:e("profile.phoneNumberPlaceholder"),value:ne.phone_number,onChange:e=>le(r=>({...r,phone_number:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-purple-500 dark:focus:border-purple-400 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 transition-all text-sm"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"doctor_service_id",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e("services.serviceName")]}),o.jsx(N,{value:ne.doctor_service_id,onChange:e=>le(r=>({...r,doctor_service_id:e})),options:z.map(e=>({value:e.id,label:e.name})),size:w.length>8?"sm":w.length>4?"md":"lg"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"gender",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full"}),e("profile.gender")," *"]}),o.jsx(j,{value:ne.gender,onChange:e=>le(r=>({...r,gender:e}))})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"date",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e("reservations.date")]}),o.jsx(g,{id:"date",type:"date",value:ne.date,onChange:e=>le(r=>({...r,date:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-red-500 dark:focus:border-red-400 focus:ring-2 focus:ring-red-200 dark:focus:ring-red-800 transition-all text-sm"})]})]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"start_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),e("schedule.startTime")]}),o.jsx(g,{id:"start_time",type:"time",value:ne.start_time,onChange:e=>le(r=>({...r,start_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200 dark:focus:ring-indigo-800 transition-all text-sm"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"end_time",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),e("reservations.endTime")]}),o.jsx(g,{id:"end_time",type:"time",value:ne.end_time,onChange:e=>le(r=>({...r,end_time:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-teal-500 dark:focus:border-teal-400 focus:ring-2 focus:ring-teal-200 dark:focus:ring-teal-800 transition-all text-sm"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"notes",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e("reservations.notes")]}),o.jsx(g,{id:"notes",placeholder:e("reservations.notesPlaceholder"),value:ne.notes,onChange:e=>le(r=>({...r,notes:e.target.value})),className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 focus:border-yellow-500 dark:focus:border-yellow-400 focus:ring-2 focus:ring-yellow-200 dark:focus:ring-yellow-800 transition-all text-sm"})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[o.jsx(c,{type:"button",variant:"outline",onClick:()=>K(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("common.cancel")}),o.jsx(c,{type:"submit",disabled:ce,className:"inline-flex items-center justify-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg shadow-lg transition-all text-sm disabled:cursor-not-allowed disabled:opacity-70",children:ce?o.jsxs(o.Fragment,{children:[o.jsx(h,{className:"h-4 w-4 animate-spin"}),o.jsx("span",{children:e("common.pleaseWait",{defaultValue:"ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±..."})})]}):e("reservations.addReservation")})]})]})}),Z&&(()=>{const r=m.get(Z.id),t=C(Z,r);return o.jsxs(y,{open:J,onOpenChange:Q,title:e("reservations.patientInfoTitle"),description:e("reservations.patientInfoDescription"),children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.fullName")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.full_name||"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.age")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.age?`${t.age} ${e("profile.years")}`:"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.gender")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:"male"===t.gender?e("auth.register.male"):"female"===t.gender?e("auth.register.female"):"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("profile.phoneNumber")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:t.phone_number||o.jsx("span",{className:"text-gray-400 dark:text-gray-500 italic",children:e("reservations.notAvailableOld")})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("services.serviceName")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:Z.doctor_service?.name||"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.date")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:Z.date?new Date(Z.date).toLocaleDateString("ar"===a.language?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric"}):"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("schedule.startTime")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:Z.start_time?_(Z.start_time):"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.endTime")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:Z.end_time?_(Z.end_time):"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.statusLabel")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${je(Z.status)}`,children:ke(Z.status)})})]})]}),Z.notes&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:e("reservations.notes")}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-lg px-3 py-2 text-sm min-h-[60px]",children:Z.notes})]})]}),o.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:o.jsx(c,{type:"button",variant:"outline",onClick:()=>Q(!1),className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("reservations.close")})})]})})(),re&&o.jsxs(y,{open:X,onOpenChange:Y,title:e("reservations.changeStatus"),description:e("reservations.selectNewStatus"),children:[o.jsx("div",{className:"space-y-3",children:[{value:"pending",label:e("reservations.status.pending"),icon:"â³",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",borderColor:"border-yellow-300 dark:border-yellow-700"},{value:"approved",label:e("reservations.status.approved"),icon:"âœ…",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",borderColor:"border-blue-300 dark:border-blue-700"},{value:"completed",label:e("reservations.status.completed"),icon:"âœ”ï¸",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",borderColor:"border-green-300 dark:border-green-700"},{value:"cancelled",label:e("reservations.status.cancelled"),icon:"âŒ",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",borderColor:"border-red-300 dark:border-red-700"}].map(r=>o.jsxs("button",{onClick:async()=>{if(re)try{await(async(r,a)=>{if(D(null),F(null),null!==ue)return;me(r);const t=[...w];S(e=>e.map(e=>e.id===r?{...e,status:a}:e));try{const n=await d.patch(`/api/doctor/reservations/updateStatus/${r}`,{status:a},{headers:{"Content-Type":"application/json"}});if(n.status>=400){S(t);const r=n.data?.message||e("reservations.updateError");return F(r),void Ne(r,"error")}await be();const l=m.get(r);!l||"completed"!==a&&"rejected"!==a||m.save(r,l),Ne(e("reservations.updateSuccess",{status:ke(a)}),"success");try{await ie({silent:!0})}catch(s){}}catch(n){S(t);const r=n?.response?.data?.message||e("reservations.updateError");throw F(r),Ne(r,"error"),n}finally{me(null)}})(re.id,r.value),Y(!1),ae(null)}catch{}},disabled:null!==ue,className:`w-full px-4 py-3 rounded-lg border-2 ${r.borderColor} ${re.status===r.value?`${r.color} font-bold shadow-md`:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700"} transition-all duration-200 flex items-center gap-3 disabled:opacity-60 disabled:cursor-not-allowed`,children:[o.jsx("span",{className:"text-2xl",children:r.icon}),o.jsx("span",{className:"text-base font-medium flex-1 text-right",children:r.label}),null!==ue&&ue===re?.id?o.jsx(h,{className:"h-4 w-4 animate-spin text-gray-500"}):re.status===r.value?o.jsx("span",{className:"text-lg",children:"âœ“"}):null]},r.value))}),o.jsx("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700 mt-4",children:o.jsx(c,{type:"button",variant:"outline",onClick:()=>{Y(!1),ae(null)},className:"px-4 py-2 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg font-medium transition-all text-sm",children:e("common.cancel")})})]}),o.jsxs(x,{children:[o.jsxs("div",{className:"flex-1 min-w-[180px]",children:[o.jsxs("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e("common.search")," ",P!==U&&o.jsxs("span",{className:"text-xs text-gray-500",children:["(",e("common.searching"),")"]})]}),o.jsx(g,{id:"search",placeholder:e("reservations.searchPlaceholder"),value:P,onChange:e=>G(e.target.value),className:"dark:bg-zinc-800 dark:border-zinc-700 dark:text-gray-100 dark:placeholder:text-gray-400"})]}),o.jsx("div",{className:"flex-1 min-w-[140px]",children:o.jsx(b,{options:[{value:"all",label:e("reservations.allStatuses")},{value:"pending",label:e("reservations.status.pending")},{value:"approved",label:e("reservations.status.approved")},{value:"completed",label:e("reservations.status.completed")},{value:"cancelled",label:e("reservations.status.cancelled")}],value:B,onChange:q,placeholder:e("reservations.selectStatus"),className:"min-w-[140px]",section:"bookings",size:"sm"})}),o.jsx("div",{className:"flex items-end",children:o.jsx(c,{onClick:()=>{G(""),q("all")},section:"bookings",size:"sm",className:"w-full",children:e("common.reset")})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-6",children:[o.jsx(p,{icon:o.jsx(k,{className:"text-primary dark:text-primary-light"}),label:e("reservations.totalReservations"),value:he.length,color:"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-light"}),o.jsx(p,{icon:o.jsx(v,{className:"text-yellow-600 dark:text-yellow-300"}),label:e("reservations.status.pending"),value:he.filter(e=>"pending"===e.status).length,color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"}),o.jsx(p,{icon:o.jsx(u,{className:"text-green-600 dark:text-green-400"}),label:e("reservations.status.approved"),value:he.filter(e=>"approved"===e.status).length,color:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400"})]}),fe.length>0?o.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-white dark:bg-zinc-900 shadow-xl dark:shadow-2xl border border-gray-100 dark:border-zinc-800 fade-in pb-4",style:{marginBottom:"50px"},children:o.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[80vh] custom-scrollbar",children:o.jsxs("table",{className:"min-w-full divide-y-0",children:[o.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-zinc-800 dark:to-zinc-800/90 sticky top-0 z-10 border-b-2 border-blue-200 dark:border-zinc-700",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),o.jsx("span",{children:e("reservations.columns.patient")})]})}),o.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),o.jsx("span",{children:e("reservations.columns.contact")})]})}),o.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),o.jsx("span",{children:e("reservations.columns.service")})]})}),o.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),o.jsx("span",{children:e("reservations.columns.appointment")})]})}),o.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),o.jsx("span",{children:e("reservations.columns.status")})]})}),o.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:e("services.actions")})]})}),o.jsx("tbody",{className:"divide-y-2 divide-gray-100 dark:divide-zinc-800",children:fe.map((r,t)=>{const s=m.get(r.id),n=C(r,s);return o.jsxs("tr",{className:"group transition-all duration-200 hover:bg-blue-50 dark:hover:bg-zinc-800 "+(t%2==0?"bg-white dark:bg-zinc-900":"bg-gray-100 dark:bg-zinc-800/80"),children:[o.jsx("td",{className:"px-6 py-5",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg text-sm",children:(n.full_name||e("reservations.defaultInitial"))[0].toUpperCase()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 truncate mb-1",children:n.full_name||"-"}),o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1.5",children:["male"===n.gender?"ðŸ‘¨":"female"===n.gender?"ðŸ‘©":"ðŸ‘¤",o.jsx("span",{children:n.age?`${n.age} ${e("profile.years")}`:"-"})]})]})]})}),o.jsx("td",{className:"px-6 py-5",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-sm",children:o.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"ðŸ“±"})}),n.phone_number?o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 dir-ltr",children:n.phone_number}):o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 italic",children:e("reservations.notAvailable")})]})}),o.jsx("td",{className:"px-6 py-5",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-sm",children:o.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"ðŸ¥"})}),o.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r.doctor_service?.name||"-"})]})}),o.jsx("td",{className:"px-6 py-5",children:o.jsxs("div",{className:"space-y-1.5",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-900 dark:text-gray-100",children:[o.jsx("span",{className:"text-green-600 dark:text-green-400",children:"ðŸ“…"}),o.jsx("span",{children:r.date?new Date(r.date).toLocaleDateString("ar"===a.language?"ar-EG":"en-US",{month:"short",day:"numeric"}):"-"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[o.jsx("span",{children:"â°"}),o.jsx("span",{className:"font-mono",children:r.start_time?_(r.start_time):"-"}),o.jsx("span",{children:"â†’"}),o.jsx("span",{className:"font-mono",children:r.end_time?_(r.end_time):"-"})]})]})}),o.jsx("td",{className:"px-6 py-5 text-center",children:o.jsxs("span",{className:`inline-flex items-center gap-1.5 px-4 py-2 rounded-full text-xs font-bold shadow-sm ${je(r.status)} transition-all duration-200 hover:scale-105`,children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-pulse"}),ke(r.status)]})}),o.jsx("td",{className:"px-6 py-5",children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsxs("button",{onClick:()=>{const e=m.get(r.id);C(r,e),ee(r),Q(!0)},className:"group/btn relative w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200",title:e("reservations.viewPatientInfo"),children:[o.jsx(f,{size:18,className:"relative z-10"}),o.jsx("div",{className:"absolute inset-0 rounded-xl bg-white opacity-0 group-hover/btn:opacity-20 transition-opacity"})]}),o.jsx("button",{onClick:()=>{ae(r),Y(!0)},className:"group/status w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 dark:from-zinc-700 dark:to-zinc-800 dark:hover:from-zinc-600 dark:hover:to-zinc-700 shadow-md hover:shadow-lg transform hover:scale-110 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:e("reservations.changeStatus"),children:o.jsx("span",{className:"text-lg",children:"âš™ï¸"})})]})})]},r.id)})})]})})}):o.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-zinc-900 dark:to-zinc-800 border-2 border-dashed border-blue-300 dark:border-zinc-700 p-12 text-center fade-in",style:{marginBottom:"60px"},children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/20 rounded-full -mr-16 -mt-16 opacity-50"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-indigo-200 dark:bg-indigo-900/20 rounded-full -ml-20 -mb-20 opacity-50"}),o.jsxs("div",{className:"relative z-10 space-y-4",children:[o.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-4xl",children:"ðŸ“‹"}),o.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:e("reservations.noReservations")}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:e("reservations.noReservationsFound")}),o.jsxs(c,{onClick:()=>{K(!0),ye()},section:"bookings",className:"mt-4",children:["+ ",e("reservations.addNewReservation")]})]})]}),ve>1&&o.jsxs("div",{className:"flex justify-center gap-4",children:[o.jsx(c,{variant:"outline",onClick:()=>W(e=>Math.max(e-1,1)),disabled:1===V,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:e("common.previous")}),o.jsx("span",{className:"flex items-center px-4 text-gray-700 dark:text-gray-300",children:e("reservations.pageInfo",{current:V,total:ve})}),o.jsx(c,{variant:"outline",onClick:()=>W(e=>Math.min(e+1,ve)),disabled:V===ve,className:"dark:border-zinc-700 dark:text-gray-100 dark:hover:bg-zinc-800",children:e("common.next")})]})]})});function _(e){if(!e)return"-";const[r,a]=e.split(":");return`${r}:${a}`}function C(e,r){if(r)return{full_name:r.full_name||e.full_name||e.user?.account?.full_name||e.user?.full_name||"",phone_number:r.phone_number||e.phone_number||e.user?.account?.phone_number||e.user?.phone_number||"",age:r.age||e.age||e.user?.age||"",gender:r.gender||e.gender||e.user?.gender||""};if(e.full_name&&e.phone_number)return{full_name:e.full_name,phone_number:e.phone_number,age:e.age||"",gender:e.gender||""};const a=e.user?.account?.phone_number||e.user?.phone_number||e.user?.account?.phone||e.user?.phone||e.phone_number||e.phone||e.mobile||e.user?.mobile||e.user?.account?.mobile||e.user?.contact_number||e.contact_number||e.user?.telephone||e.telephone||"";return{full_name:e.user?.account?.full_name||e.user?.full_name||"",phone_number:a,age:e.user?.age||e.age||"",gender:e.user?.gender||e.gender||""}}export{w as default};
