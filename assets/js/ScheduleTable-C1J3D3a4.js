import{n as e,r as a,j as r,aa as t,a0 as s}from"./react-vendor-DiQFFM99.js";import{D as d}from"./index-CwAtTAxG.js";import{S as n,h as l,j as i,k as o,m as c,d as u,B as y,s as m,a as x,L as g}from"./index-BTp-thJS.js";import{b as p}from"./axios-CWOAZBIW.js";import"./vendor-D4U6VxjQ.js";import"./i18n-vendor-aVkm1h7f.js";import"./api.config-kPv0EHGZ.js";import"./animation-vendor-DLLeU5Bd.js";import"./http-vendor-vzM7rUwp.js";const h=({isOpen:t,onClose:s,onEdit:m,initialData:x})=>{const{t:g}=e(),[p,h]=a.useState({day:"",start:"",end:""});return a.useEffect(()=>{x&&h({day:x.day,start:x.start,end:x.end})},[x]),r.jsx(d,{open:t,onOpenChange:s,title:g("schedule.editAppointment")||g("common.edit"),description:g("schedule.editAppointmentDesc")||"قم بتحديث تفاصيل الموعد",children:r.jsxs("form",{onSubmit:e=>{e.preventDefault();const a={id:x.id,...p};m(a),s()},className:"space-y-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),g("schedule.day")||"اليوم"]}),r.jsxs(n,{value:p.day,onValueChange:e=>h(a=>({...a,day:e})),children:[r.jsx(l,{className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-xl px-4 py-3 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all",children:r.jsx(i,{placeholder:g("schedule.selectDay")||"اختر اليوم"})}),r.jsx(o,{className:"dark:bg-gray-800 dark:border-gray-700 bg-white border-2 border-gray-200 rounded-xl",children:["saturday","sunday","monday","tuesday","wednesday","thursday","friday"].map(e=>r.jsx(c,{value:e,className:"text-gray-900 dark:text-white hover:bg-blue-50 dark:hover:bg-blue-900/20 focus:bg-blue-50 dark:focus:bg-blue-900/20",children:g(`schedule.days.${e}`)},e))})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),g("schedule.startTime")]}),r.jsx(u,{type:"time",value:p.start,onChange:e=>h(a=>({...a,start:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-xl px-4 py-3 focus:border-green-500 dark:focus:border-green-400 focus:ring-2 focus:ring-green-200 dark:focus:ring-green-800 transition-all"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),g("schedule.endTime")]}),r.jsx(u,{type:"time",value:p.end,onChange:e=>h(a=>({...a,end:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-xl px-4 py-3 focus:border-purple-500 dark:focus:border-purple-400 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 transition-all"})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[r.jsx(y,{type:"button",variant:"outline",onClick:s,className:"px-6 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl font-medium transition-all",children:g("common.cancel")}),r.jsx(y,{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700 text-white font-medium rounded-xl shadow-lg transition-all",children:g("schedule.updateAppointment")||g("common.save")})]})]})})},b=["saturday","sunday","monday","tuesday","wednesday","thursday","friday"];function f({value:t,onChange:s}){const{t:d}=e(),[n,l]=a.useState(!1),i=a.useRef(null);return a.useEffect(()=>{function e(e){i.current&&!i.current.contains(e.target)&&l(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),r.jsxs("div",{className:"relative w-full",ref:i,children:[r.jsxs("button",{type:"button",className:"w-full px-4 py-3 border-2 border-cyan-400 dark:border-cyan-600 rounded-xl bg-white dark:bg-gray-800 text-right text-gray-800 dark:text-gray-100 font-medium focus:outline-none focus:ring-2 focus:ring-cyan-300 dark:focus:ring-cyan-700 transition",onClick:()=>l(e=>!e),children:[t?d(`schedule.days.${t}`):d("schedule.selectDay")||"اختر اليوم",r.jsx("span",{className:"float-left",children:n?"▲":"▼"})]}),n&&r.jsx("div",{className:"absolute z-50 w-full bg-white dark:bg-gray-800 border-2 border-cyan-400 dark:border-cyan-600 rounded-xl shadow-lg mt-2 max-h-[25vh] overflow-y-auto",children:b.map(e=>r.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-cyan-50 dark:hover:bg-cyan-900/30 text-gray-900 dark:text-gray-100 "+(t===e?"bg-cyan-100 dark:bg-cyan-900/50 font-bold":""),onClick:()=>{s(e),l(!1)},children:d(`schedule.days.${e}`)},e))})]})}const w=({isOpen:t,onClose:s,onAdd:n})=>{const{t:l}=e(),[i,o]=a.useState({day:"",start:"",end:""});return r.jsx(d,{open:t,onOpenChange:s,title:l("schedule.addNewAppointment")||l("schedule.addAppointment"),description:l("schedule.addAppointmentDesc")||"أدخل تفاصيل الموعد الجديد",children:r.jsxs("form",{onSubmit:e=>{e.preventDefault();const a={day:m(i.day),start:m(i.start),end:m(i.end)},r={id:Date.now(),...a};n(r),o({day:"",start:"",end:""})},className:"space-y-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),l("schedule.day")||"اليوم"]}),r.jsx(f,{value:i.day,onChange:e=>o(a=>({...a,day:e}))})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),l("schedule.startTime")]}),r.jsx(u,{type:"time",value:i.start,onChange:e=>o(a=>({...a,start:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-xl px-4 py-3 focus:border-green-500 dark:focus:border-green-400 focus:ring-2 focus:ring-green-200 dark:focus:ring-green-800 transition-all"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),l("schedule.endTime")]}),r.jsx(u,{type:"time",value:i.end,onChange:e=>o(a=>({...a,end:e.target.value})),required:!0,className:"w-full bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 rounded-xl px-4 py-3 focus:border-purple-500 dark:focus:border-purple-400 focus:ring-2 focus:ring-purple-200 dark:focus:ring-purple-800 transition-all"})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[r.jsx(y,{type:"button",variant:"outline",onClick:s,className:"px-6 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl font-medium transition-all",children:l("common.cancel")}),r.jsx(y,{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-xl shadow-lg transition-all",children:l("schedule.addAppointment")})]})]})})},k=()=>{const{t:d,i18n:n}=e();n.language;const l={saturday:d("schedule.days.saturday"),sunday:d("schedule.days.sunday"),monday:d("schedule.days.monday"),tuesday:d("schedule.days.tuesday"),wednesday:d("schedule.days.wednesday"),thursday:d("schedule.days.thursday"),friday:d("schedule.days.friday")},i=Object.fromEntries(Object.entries(l).map(([e,a])=>[a,e])),[o,c]=a.useState([]),[u,m]=a.useState(!0),[b,f]=a.useState(null),[k,v]=a.useState(null),[N,_]=a.useState(null),S=(e,a)=>{_({message:e,type:a}),setTimeout(()=>_(null),3e3)},[C,A]=a.useState(1),[E,z]=a.useState(3);a.useLayoutEffect(()=>{const e=()=>{"undefined"!=typeof window&&(window.innerWidth>=1024?z(3):window.innerWidth>=640?z(4):z(5))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const D=Math.ceil(o.length/E),O=["saturday","sunday","monday","tuesday","wednesday","thursday","friday"],L=[...o].sort((e,a)=>O.indexOf(e.day_of_week)-O.indexOf(a.day_of_week)).slice((C-1)*E,C*E),[T,$]=a.useState(!1),[q,R]=a.useState(null),W=Object.keys(l).find(e=>l[e]===l[(new Date).toLocaleDateString("ar-EG",{weekday:"long"})])||"",{isAuthenticated:I}=x();a.useEffect(()=>{I&&M()},[I]);const M=async()=>{m(!0),f(null);try{const e=(await p.get("/api/doctor/schedules")).data,a=Array.isArray(e)?e:Array.isArray(e.data)?e.data:[];c(a)}catch(e){f(d("schedule.loadingError"))}finally{m(!1)}};return u?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx(g,{size:"lg"})}):r.jsxs("div",{className:"space-y-6 min-h-0 relative",children:[r.jsx("div",{className:"flex justify-end gap-2",children:r.jsxs(y,{onClick:()=>$(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md text-sm sm:text-base font-medium",children:["+ ",d("schedule.addNewAppointment")||d("schedule.addAppointment")]})}),b&&r.jsx("div",{className:"text-center text-red-500 py-2",children:b}),k&&r.jsx("div",{className:"text-center text-green-600 font-bold py-2",children:k}),r.jsx(w,{isOpen:T,onClose:()=>$(!1),onAdd:async e=>{await(async e=>{v(null),f(null);try{const a=new URLSearchParams;a.append("day_of_week",i[e.day]),a.append("start_time",e.start?.slice(0,5)),a.append("end_time",e.end?.slice(0,5));const r=await p.post("/api/doctor/schedules",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}),t=r.data&&"object"==typeof r.data&&!Array.isArray(r.data)&&r.data.data?r.data.data:r.data;c(e=>[...e,t]),S(d("schedule.addSuccess"),"success")}catch(a){const e=a?.response?.data?.message;let r=d("schedule.addError");e&&e.includes("validation")?r=d("services.invalidData"):e&&e.includes("required")?r=d("services.allFieldsRequired"):e&&e.includes("conflict")&&(r=d("schedule.addError")),S(r,"error")}})(e),$(!1)},existingSchedule:o.map(e=>({id:e.id,day:l[e.day_of_week],start:e.start_time,end:e.end_time}))}),null!==q&&r.jsx(h,{isOpen:null!==q,onClose:()=>R(null),onEdit:async e=>{await(async e=>{if(v(null),f(null),e&&e.id)try{const a=new URLSearchParams;a.append("day_of_week",i[e.day]),a.append("start_time",e.start?.slice(0,5)),a.append("end_time",e.end?.slice(0,5));const r=await p.post(`/api/doctor/schedules/${e.id}`,a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}),t=r.data&&"object"==typeof r.data&&!Array.isArray(r.data)&&r.data.data?r.data.data:r.data;c(a=>a.map(a=>a.id===e.id?t:a)),S(d("schedule.updateSuccess"),"success")}catch(a){S(d("schedule.updateError"),"error")}else S(d("schedule.updateError"),"error")})(e),R(null)},initialData:(()=>{const e=o[q];return{id:e.id,day:l[e.day_of_week],start:e.start_time,end:e.end_time}})()}),r.jsx("div",{className:"relative rounded-3xl shadow-lg bg-white mt-4 fade-in dark:bg-card-dark dark:shadow-[0_2px_16px_0_rgba(36,44,80,0.18)] rounded-tl-[2.5rem] rounded-br-[2.5rem] overflow-hidden",children:r.jsx("div",{className:"w-full overflow-x-auto",children:r.jsxs("table",{className:"min-w-full w-full divide-y divide-gray-200 dark:divide-zinc-700 text-center align-middle",children:[r.jsx("thead",{className:"bg-slate-50 dark:bg-zinc-800 sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs font-bold text-white uppercase tracking-wide whitespace-nowrap bg-green-600 dark:bg-green-800",children:d("schedule.day")||"اليوم"}),r.jsx("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wide whitespace-nowrap",children:d("schedule.startTime")}),r.jsx("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wide whitespace-nowrap",children:d("schedule.endTime")}),r.jsx("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs font-bold text-gray-700 dark:text-gray-200 uppercase tracking-wide whitespace-nowrap",children:d("services.actions")})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-zinc-800",children:L.map((e,a)=>{const n=e.day_of_week===W;return r.jsxs("tr",{className:`transition-colors ${n?"bg-yellow-50 dark:bg-yellow-900/30":a%2==0?"bg-white dark:bg-zinc-900":"bg-gray-50 dark:bg-zinc-800"} hover:bg-accent/10 dark:hover:bg-zinc-700`,children:[r.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 whitespace-nowrap font-medium text-gray-900 dark:text-gray-100 text-center align-middle text-sm sm:text-base",children:l[e.day_of_week]}),r.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 whitespace-nowrap text-gray-900 dark:text-gray-100 text-center align-middle text-sm sm:text-base",children:j(e.start_time)}),r.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 whitespace-nowrap text-gray-900 dark:text-gray-100 text-center align-middle text-sm sm:text-base",children:j(e.end_time)}),r.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 whitespace-nowrap text-center align-middle",children:r.jsxs("div",{className:"flex justify-center gap-2 sm:gap-3",children:[r.jsx("button",{type:"button",onClick:(o=(C-1)*E+a,()=>{R(o)}),className:"w-7 h-7 sm:w-9 sm:h-9 flex items-center justify-center rounded-full bg-blue-100 hover:bg-blue-200 text-blue-600 shadow transition-all dark:bg-blue-700 dark:hover:bg-blue-800 dark:text-white",title:d("common.edit"),children:r.jsx(t,{size:14,className:"sm:w-4 sm:h-4"})}),r.jsx("button",{type:"button",onClick:(i=e.id,()=>{(async e=>{if(v(null),f(null),e)try{await p.delete(`/api/doctor/schedules/${e}`),c(a=>a.filter(a=>a.id!==e)),S(d("schedule.deleteSuccess"),"success")}catch(a){S(d("schedule.deleteError"),"error")}else S(d("schedule.deleteError"),"error")})(i)}),className:"w-7 h-7 sm:w-9 sm:h-9 flex items-center justify-center rounded-full bg-red-100 hover:bg-red-200 text-red-600 shadow transition-all dark:bg-red-700 dark:hover:bg-red-800 dark:text-white",title:d("common.delete"),children:r.jsx(s,{size:14,className:"sm:w-4 sm:h-4"})})]})})]},e.id);var i,o})})]})})}),r.jsxs("div",{className:"flex justify-center gap-2 sm:gap-4 mt-4",children:[r.jsx(y,{onClick:()=>A(e=>Math.max(e-1,1)),disabled:1===C,className:"px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-green-700 transition-colors text-sm",children:"السابق"}),r.jsxs("span",{className:"self-center text-gray-700 text-sm sm:text-base",children:["صفحة ",C," من ",D]}),r.jsx(y,{onClick:()=>A(e=>Math.min(e+1,D)),disabled:C===D,className:"px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-green-700 transition-colors text-sm",children:"التالي"})]}),N&&r.jsxs("div",{style:{position:"fixed",bottom:18,left:18,zIndex:99999,minWidth:120,maxWidth:220,padding:"7px 16px 7px 10px",borderRadius:"8px",background:"success"===N.type?"#22c55e":"#ef4444",color:"#fff",fontWeight:500,fontSize:"0.85rem",boxShadow:"0 2px 8px rgba(0,0,0,0.13)",display:"flex",alignItems:"center",gap:7,pointerEvents:"none",userSelect:"none"},children:[r.jsx("span",{style:{fontSize:"1.1em",marginRight:6,display:"flex",alignItems:"center"},children:"success"===N.type?"✔️":"⚠️"}),r.jsx("span",{style:{flex:1},children:N.message})]})]})};function j(e){if(!e)return"-";const[a,r]=e.split(":");return`${a}:${r}`}export{k as default};
